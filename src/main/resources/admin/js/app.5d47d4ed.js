(function(){var e={71240:function(e,t,a){"use strict";a.d(t,{Z:function(){return h}});var n=function(){var e=this,t=e._self._c;return t("div",{ref:"codemirrorRef"})},i=[],s=a(66932),o=a(75533),l=a(78120),r=a(45383),d={name:"Codemirror",model:{prop:"value",event:"update:value"},props:{value:{type:String,default:""},extensions:{type:Array,default:()=>[]},height:{type:String,default:"500px"}},data(){return{codemirrorState:null,codemirrorView:null}},mounted(){this.handleInitCodemirror()},beforeDestroy(){this.codemirrorView&&this.codemirrorView.destroy()},methods:{handleInitCodemirror(){this.codemirrorView&&this.codemirrorView.destroy();const e=this.$refs.codemirrorRef,t=o.tk.updateListener.of((e=>{if(e.docChanged){const t=e.state.doc;this.$emit("update:value",t.toString())}})),a=o.tk.theme({"&":{height:this.height}});this.codemirrorState=l.yy.create({doc:this.value,extensions:[s.Xy,t,o.$f.of([r.oc]),a,...this.extensions]}),this.codemirrorView=new o.tk({state:this.codemirrorState,parent:e})}}},c=d,u=a(1001),m=(0,u.Z)(c,n,i,!1,null,null,null),h=m.exports},11322:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var n=function(){var e=this,t=e._self._c;return t("div",[t("a-form-model",{ref:"loginForm",attrs:{model:e.form.model,rules:e.form.rules,layout:"vertical"},nativeOn:{keyup:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.form.needAuthCode?e.handleLogin():e.handleLoginClick()}}},[e.form.needAuthCode?e._e():t("a-form-model-item",{attrs:{prop:"username"}},[t("a-input",{attrs:{placeholder:"用户名/邮箱"},model:{value:e.form.model.username,callback:function(t){e.$set(e.form.model,"username",t)},expression:"form.model.username"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),e.form.needAuthCode?e._e():t("a-form-model-item",{attrs:{prop:"password"}},[t("a-input",{attrs:{placeholder:"密码",type:"password"},model:{value:e.form.model.password,callback:function(t){e.$set(e.form.model,"password",t)},expression:"form.model.password"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),e.form.needAuthCode?t("a-form-model-item",{attrs:{prop:"authcode"}},[t("a-input",{attrs:{maxLength:6,placeholder:"两步验证码"},model:{value:e.form.model.authcode,callback:function(t){e.$set(e.form.model,"authcode",t)},expression:"form.model.authcode"}},[t("a-icon",{staticStyle:{color:"rgba(0, 0, 0, 0.25)"},attrs:{slot:"prefix",type:"safety-certificate"},slot:"prefix"})],1)],1):e._e(),t("a-form-model-item",[t("a-button",{attrs:{block:!0,loading:e.form.logging,type:"primary"},on:{click:function(t){e.form.needAuthCode?e.handleLogin():e.handleLoginClick()}}},[e._v(" "+e._s(e.buttonName)+" ")])],1)],1)],1)},i=[],s=a(20629),o=a(73541),l={name:"LoginForm",data(){const e=(e,t,a)=>{!t&&this.form.needAuthCode?a(new Error("* 请输入两步验证码")):a()};return{form:{model:{authcode:null,password:null,username:null},rules:{username:[{required:!0,message:"* 用户名/邮箱不能为空",trigger:["change"]}],password:[{required:!0,message:"* 密码不能为空",trigger:["change"]}],authcode:[{validator:e,trigger:["change"]}]},needAuthCode:!1,logging:!1}}},computed:{buttonName(){return this.form.needAuthCode?"验证":"登录"}},methods:{...(0,s.nv)(["login","refreshUserCache","refreshOptionsCache"]),handleLoginClick(){const e=this;e.$refs.loginForm.validate((t=>{t&&(e.form.logging=!0,o.Z.needMFACode({username:e.form.model.username,password:e.form.model.password}).then((t=>{const a=t.data;a&&a.needMFACode?(e.form.needAuthCode=!0,e.form.model.authcode=null):e.handleLogin()})).finally((()=>{setTimeout((()=>{e.form.logging=!1}),300)})))}))},handleLogin(){const e=this;e.$refs.loginForm.validate((t=>{t&&(e.form.logging=!0,e.login(e.form.model).then((()=>{e.$emit("success")})).finally((()=>{setTimeout((()=>{e.form.logging=!1}),300)})))}))}}},r=l,d=a(1001),c=(0,d.Z)(r,n,i,!1,null,null,null),u=c.exports},46700:function(e,t,a){var n={"./af":42786,"./af.js":42786,"./ar":30867,"./ar-dz":14130,"./ar-dz.js":14130,"./ar-kw":96135,"./ar-kw.js":96135,"./ar-ly":56440,"./ar-ly.js":56440,"./ar-ma":47702,"./ar-ma.js":47702,"./ar-sa":16040,"./ar-sa.js":16040,"./ar-tn":37100,"./ar-tn.js":37100,"./ar.js":30867,"./az":31083,"./az.js":31083,"./be":9808,"./be.js":9808,"./bg":68338,"./bg.js":68338,"./bm":67438,"./bm.js":67438,"./bn":8905,"./bn-bd":76225,"./bn-bd.js":76225,"./bn.js":8905,"./bo":11560,"./bo.js":11560,"./br":1278,"./br.js":1278,"./bs":80622,"./bs.js":80622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":50877,"./cv.js":50877,"./cy":47373,"./cy.js":47373,"./da":24780,"./da.js":24780,"./de":59740,"./de-at":60217,"./de-at.js":60217,"./de-ch":60894,"./de-ch.js":60894,"./de.js":59740,"./dv":5300,"./dv.js":5300,"./el":50837,"./el.js":50837,"./en-au":78348,"./en-au.js":78348,"./en-ca":77925,"./en-ca.js":77925,"./en-gb":22243,"./en-gb.js":22243,"./en-ie":46436,"./en-ie.js":46436,"./en-il":47207,"./en-il.js":47207,"./en-in":44175,"./en-in.js":44175,"./en-nz":76319,"./en-nz.js":76319,"./en-sg":31662,"./en-sg.js":31662,"./eo":92915,"./eo.js":92915,"./es":55655,"./es-do":55251,"./es-do.js":55251,"./es-mx":96112,"./es-mx.js":96112,"./es-us":71146,"./es-us.js":71146,"./es.js":55655,"./et":5603,"./et.js":5603,"./eu":77763,"./eu.js":77763,"./fa":76959,"./fa.js":76959,"./fi":11897,"./fi.js":11897,"./fil":42549,"./fil.js":42549,"./fo":94694,"./fo.js":94694,"./fr":94470,"./fr-ca":63049,"./fr-ca.js":63049,"./fr-ch":52330,"./fr-ch.js":52330,"./fr.js":94470,"./fy":5044,"./fy.js":5044,"./ga":29295,"./ga.js":29295,"./gd":2101,"./gd.js":2101,"./gl":38794,"./gl.js":38794,"./gom-deva":27884,"./gom-deva.js":27884,"./gom-latn":23168,"./gom-latn.js":23168,"./gu":95349,"./gu.js":95349,"./he":24206,"./he.js":24206,"./hi":30094,"./hi.js":30094,"./hr":30316,"./hr.js":30316,"./hu":22138,"./hu.js":22138,"./hy-am":11423,"./hy-am.js":11423,"./id":29218,"./id.js":29218,"./is":90135,"./is.js":90135,"./it":90626,"./it-ch":10150,"./it-ch.js":10150,"./it.js":90626,"./ja":39183,"./ja.js":39183,"./jv":24286,"./jv.js":24286,"./ka":12105,"./ka.js":12105,"./kk":47772,"./kk.js":47772,"./km":18758,"./km.js":18758,"./kn":79282,"./kn.js":79282,"./ko":33730,"./ko.js":33730,"./ku":1408,"./ku.js":1408,"./ky":33291,"./ky.js":33291,"./lb":36841,"./lb.js":36841,"./lo":55466,"./lo.js":55466,"./lt":57010,"./lt.js":57010,"./lv":37595,"./lv.js":37595,"./me":39861,"./me.js":39861,"./mi":35493,"./mi.js":35493,"./mk":95966,"./mk.js":95966,"./ml":87341,"./ml.js":87341,"./mn":5115,"./mn.js":5115,"./mr":10370,"./mr.js":10370,"./ms":9847,"./ms-my":41237,"./ms-my.js":41237,"./ms.js":9847,"./mt":72126,"./mt.js":72126,"./my":56165,"./my.js":56165,"./nb":64924,"./nb.js":64924,"./ne":16744,"./ne.js":16744,"./nl":93901,"./nl-be":59814,"./nl-be.js":59814,"./nl.js":93901,"./nn":83877,"./nn.js":83877,"./oc-lnc":92135,"./oc-lnc.js":92135,"./pa-in":15858,"./pa-in.js":15858,"./pl":64495,"./pl.js":64495,"./pt":89520,"./pt-br":57971,"./pt-br.js":57971,"./pt.js":89520,"./ro":96459,"./ro.js":96459,"./ru":21793,"./ru.js":21793,"./sd":40950,"./sd.js":40950,"./se":10490,"./se.js":10490,"./si":90124,"./si.js":90124,"./sk":64249,"./sk.js":64249,"./sl":14985,"./sl.js":14985,"./sq":51104,"./sq.js":51104,"./sr":49131,"./sr-cyrl":79915,"./sr-cyrl.js":79915,"./sr.js":49131,"./ss":85893,"./ss.js":85893,"./sv":98760,"./sv.js":98760,"./sw":91172,"./sw.js":91172,"./ta":27333,"./ta.js":27333,"./te":23110,"./te.js":23110,"./tet":52095,"./tet.js":52095,"./tg":27321,"./tg.js":27321,"./th":9041,"./th.js":9041,"./tk":19005,"./tk.js":19005,"./tl-ph":75768,"./tl-ph.js":75768,"./tlh":89444,"./tlh.js":89444,"./tr":72397,"./tr.js":72397,"./tzl":28254,"./tzl.js":28254,"./tzm":51106,"./tzm-latn":30699,"./tzm-latn.js":30699,"./tzm.js":51106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":67691,"./uk.js":67691,"./ur":13795,"./ur.js":13795,"./uz":6791,"./uz-latn":60588,"./uz-latn.js":60588,"./uz.js":6791,"./vi":65666,"./vi.js":65666,"./x-pseudo":14378,"./x-pseudo.js":14378,"./yo":75805,"./yo.js":75805,"./zh-cn":83839,"./zh-cn.js":83839,"./zh-hk":55726,"./zh-hk.js":55726,"./zh-mo":99807,"./zh-mo.js":99807,"./zh-tw":74152,"./zh-tw.js":74152};function i(e){var t=s(e);return a(t)}function s(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=s,e.exports=i,i.id=46700},15899:function(e,t){"use strict";t.Z={primaryColor:"#1890FF",navTheme:"dark",layout:"sidemenu",contentWidth:"Fixed",fixedHeader:!1,fixedSidebar:!0,autoHideHeader:!1,storageOptions:{namespace:"HALO__",name:"ls",storage:"local"}}},45695:function(e,t,a){"use strict";a.d(t,{j:function(){return i},k:function(){return s}});var n=a(67731);const i=[{path:"/",name:"index",component:n.iO,meta:{title:"首页"},redirect:"/dashboard",children:[{path:"/dashboard",name:"Dashboard",component:()=>a.e(5201).then(a.bind(a,5201)),meta:{title:"仪表盘",icon:"dashboard",hiddenHeaderContent:!1,keepAlive:!1}},{path:"/posts",name:"Posts",component:n.it,redirect:"/posts/list",meta:{title:"文章",icon:"form"},children:[{path:"/posts/list",name:"PostList",component:()=>Promise.all([a.e(1044),a.e(3339),a.e(1195)]).then(a.bind(a,11195)),meta:{title:"所有文章",hiddenHeaderContent:!1}},{path:"/posts/write",name:"PostWrite",component:()=>Promise.all([a.e(1044),a.e(7378),a.e(3339),a.e(4849)]).then(a.bind(a,4849)),meta:{title:"写文章",hiddenHeaderContent:!1,keepAlive:!1}},{path:"/posts/edit",name:"PostEdit",hidden:!0,component:()=>Promise.all([a.e(1044),a.e(7378),a.e(3339),a.e(4849)]).then(a.bind(a,4849)),meta:{title:"编辑文章",hiddenHeaderContent:!1,keepAlive:!1}},{path:"/categories",name:"CategoryList",component:()=>Promise.all([a.e(9980),a.e(5084)]).then(a.bind(a,25084)),meta:{title:"分类目录",hiddenHeaderContent:!1}},{path:"/tags",name:"TagList",component:()=>a.e(9975).then(a.bind(a,99975)),meta:{title:"标签",hiddenHeaderContent:!1}}]},{path:"/sheets",name:"Sheets",component:n.it,redirect:"/sheets/list",meta:{title:"页面",icon:"read"},children:[{path:"/sheets/list",name:"SheetList",component:()=>Promise.all([a.e(1044),a.e(1909)]).then(a.bind(a,71909)),meta:{title:"所有页面",hiddenHeaderContent:!1}},{path:"/sheets/write",name:"SheetWrite",component:()=>Promise.all([a.e(1044),a.e(7378),a.e(3541)]).then(a.bind(a,3541)),meta:{title:"新建页面",hiddenHeaderContent:!1,keepAlive:!1}},{path:"/sheets/edit",name:"SheetEdit",hidden:!0,component:()=>Promise.all([a.e(1044),a.e(7378),a.e(3541)]).then(a.bind(a,3541)),meta:{title:"编辑页面",hiddenHeaderContent:!1,keepAlive:!1}},{path:"/sheets/links",name:"LinkList",hidden:!0,component:()=>Promise.all([a.e(9980),a.e(4368)]).then(a.bind(a,94368)),meta:{title:"友情链接",hiddenHeaderContent:!1}},{path:"/sheets/photos",name:"PhotoList",hidden:!0,component:()=>a.e(1162).then(a.bind(a,61162)),meta:{title:"图库",hiddenHeaderContent:!1}},{path:"/sheets/journals",name:"JournalList",hidden:!0,component:()=>Promise.all([a.e(7378),a.e(1261)]).then(a.bind(a,1261)),meta:{title:"日志",hiddenHeaderContent:!1}}]},{path:"/attachments",name:"Attachments",component:()=>a.e(7682).then(a.bind(a,77682)),meta:{title:"附件",icon:"picture",hiddenHeaderContent:!1}},{path:"/comments",name:"Comments",component:()=>a.e(5760).then(a.bind(a,55760)),meta:{title:"评论",icon:"message",hiddenHeaderContent:!1}},{path:"/interface",name:"Interface",component:n.it,redirect:"/interface/themes",meta:{title:"外观",icon:"skin"},children:[{path:"/interface/themes",name:"ThemeList",component:()=>a.e(1010).then(a.bind(a,21010)),meta:{title:"主题",hiddenHeaderContent:!1}},{path:"/interface/themes/setting",name:"ThemeSetting",component:()=>a.e(3086).then(a.bind(a,23086)),meta:{title:"主题设置",hiddenHeaderContent:!1}},{path:"/interface/themes/edit",name:"ThemeEdit",component:()=>a.e(3203).then(a.bind(a,13203)),meta:{title:"主题编辑",hiddenHeaderContent:!1}},{path:"/interface/menus",name:"MenuList",component:()=>Promise.all([a.e(9980),a.e(9831)]).then(a.bind(a,29831)),meta:{title:"菜单设置",hiddenHeaderContent:!1}}]},{path:"/user",name:"User",component:n.B4,redirect:"/user/profile",meta:{title:"用户",icon:"user"},children:[{path:"/user/profile",name:"Profile",component:()=>a.e(6673).then(a.bind(a,6673)),meta:{title:"个人资料",hiddenHeaderContent:!1}}]},{path:"/system",name:"System",component:n.it,redirect:"/system/options",meta:{title:"系统",icon:"setting"},children:[{path:"/system/developer/options",name:"DeveloperOptions",hidden:!0,component:()=>a.e(8370).then(a.bind(a,18370)),meta:{title:"开发者选项",hiddenHeaderContent:!1}},{path:"/system/options",name:"SystemOptions",component:()=>a.e(4609).then(a.bind(a,64609)),meta:{title:"博客设置",hiddenHeaderContent:!1}},{path:"/system/tools",name:"ToolList",component:()=>a.e(1125).then(a.bind(a,31125)),meta:{title:"小工具",hiddenHeaderContent:!1}},{path:"/system/actionlogs",name:"SystemActionLogs",hidden:!0,component:()=>a.e(3311).then(a.bind(a,83311)),meta:{title:"操作日志",hiddenHeaderContent:!1}},{path:"/system/about",name:"About",component:()=>a.e(4221).then(a.bind(a,24221)),meta:{title:"关于",hiddenHeaderContent:!1}}]}]},{path:"/interface/themes/setting/visual",name:"ThemeVisualSetting",hidden:!0,component:()=>a.e(3271).then(a.bind(a,73271)),meta:{title:"主题设置",hiddenHeaderContent:!1}},{path:"*",redirect:"/404",hidden:!0}],s=[{path:"/login",name:"Login",meta:{title:"登录"},component:()=>a.e(2389).then(a.bind(a,2389))},{path:"/install",name:"Install",meta:{title:"安装向导"},component:()=>a.e(1292).then(a.bind(a,71292))},{path:"/password/reset",name:"ResetPassword",meta:{title:"重置密码"},component:()=>a.e(5747).then(a.bind(a,45747))},{path:"/404",name:"NotFound",component:()=>a.e(4510).then(a.bind(a,44510))}]},10438:function(e,t,a){"use strict";a.d(t,{JQ:function(){return l},Js:function(){return i},Zi:function(){return c},hh:function(){return o},k:function(){return s},nM:function(){return r},o6:function(){return n},v$:function(){return u},z$:function(){return d}});const n={bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,undo:!0,redo:!0,subfield:!0,htmlcode:!0,preview:!0},i={BLOG_INITIALIZED:{value:0,text:"博客初始化"},POST_PUBLISHED:{value:5,text:"文章发布"},POST_EDITED:{value:15,text:"文章修改"},POST_DELETED:{value:20,text:"文章删除"},LOGGED_IN:{value:25,text:"用户登录"},LOGGED_OUT:{value:30,text:"注销登录"},LOGIN_FAILED:{value:35,text:"登录失败"},PASSWORD_UPDATED:{value:40,text:"修改密码"},PROFILE_UPDATED:{value:45,text:"资料修改"},SHEET_PUBLISHED:{value:50,text:"页面发布"},SHEET_EDITED:{value:55,text:"页面修改"},SHEET_DELETED:{value:60,text:"页面删除"},MFA_UPDATED:{value:65,text:"两步验证"},LOGGED_PRE_CHECK:{value:70,text:"登录验证"}},s={LOCAL:{type:"LOCAL",text:"本地"},SMMS:{type:"SMMS",text:"SM.MS"},UPOSS:{type:"UPOSS",text:"又拍云"},QINIUOSS:{type:"QINIUOSS",text:"七牛云"},ALIOSS:{type:"ALIOSS",text:"阿里云"},BAIDUBOS:{type:"BAIDUBOS",text:"百度云"},TENCENTCOS:{type:"TENCENTCOS",text:"腾讯云"},HUAWEIOBS:{type:"HUAWEIOBS",text:"华为云"},MINIO:{type:"MINIO",text:"MinIO"}},o={PUBLISHED:{value:"PUBLISHED",color:"green",status:"success",text:"已发布"},INTIMATE:{value:"INTIMATE",color:"blue",status:"success",text:"私密"},DRAFT:{value:"DRAFT",color:"yellow",status:"warning",text:"草稿"}},l={...o,RECYCLE:{value:"RECYCLE",color:"red",status:"error",text:"回收站"}},r=[{title:"标题",dataIndex:"title",width:"200px",ellipsis:!0,scopedSlots:{customRender:"postTitle"}},{title:"状态",dataIndex:"status",width:"100px",scopedSlots:{customRender:"status"}},{title:"分类",dataIndex:"categories",scopedSlots:{customRender:"categories"}},{title:"标签",dataIndex:"tags",scopedSlots:{customRender:"tags"}},{title:"评论",width:"70px",dataIndex:"commentCount",scopedSlots:{customRender:"commentCount"}},{title:"访问",width:"70px",dataIndex:"visits",scopedSlots:{customRender:"visits"}},{title:"发布时间",dataIndex:"createTime",width:"170px",scopedSlots:{customRender:"createTime"}},{title:"操作",width:"180px",scopedSlots:{customRender:"action"}}],d=[{title:"标题",dataIndex:"title",width:"200px",ellipsis:!0,scopedSlots:{customRender:"postTitle"}},{title:"分类",dataIndex:"categories",scopedSlots:{customRender:"categories"}},{title:"标签",dataIndex:"tags",scopedSlots:{customRender:"tags"}},{title:"评论",width:"70px",dataIndex:"commentCount",scopedSlots:{customRender:"commentCount"}},{title:"访问",width:"70px",dataIndex:"visits",scopedSlots:{customRender:"visits"}},{title:"操作",width:"180px",scopedSlots:{customRender:"action"}}],c={PUBLISHED:{color:"green",status:"success",text:"已发布",value:"PUBLISHED"},DRAFT:{color:"yellow",status:"warning",text:"草稿",value:"DRAFT"},RECYCLE:{color:"red",status:"error",text:"回收站",value:"RECYCLE"}},u={PUBLISHED:{value:"PUBLISHED",color:"green",status:"success",text:"已发布"},AUDITING:{value:"AUDITING",color:"yellow",status:"warning",text:"待审核"},RECYCLE:{value:"RECYCLE",color:"red",status:"error",text:"回收站"}}},67731:function(e,t,a){"use strict";a.d(t,{iO:function(){return Be},it:function(){return u},B4:function(){return Ye}});var n,i,s=function(){var e=this,t=e._self._c;return t("div",[t("router-view")],1)},o=[],l={name:"BlankLayout"},r=l,d=a(1001),c=(0,d.Z)(r,s,o,!1,null,null,null),u=c.exports,m=function(){var e=this,t=e._self._c;return t("a-layout",{class:["layout",e.device]},[e.isMobile()?t("a-drawer",{attrs:{closable:!1,visible:e.collapsed,wrapClassName:`drawer-sider ${e.navTheme}`,placement:"left"},on:{close:e.drawerClose}},[t("side-menu",{attrs:{collapsed:!1,collapsible:!0,menus:e.menus,theme:e.navTheme,mode:"inline"},on:{menuSelect:e.menuSelect}})],1):e.isSideMenu()?t("side-menu",{attrs:{collapsed:e.collapsed,collapsible:!0,menus:e.menus,theme:e.navTheme,mode:"inline"}}):e._e(),t("a-layout",{class:[e.layoutMode,`content-width-${e.contentWidth}`],style:{paddingLeft:e.contentPaddingLeft,minHeight:"100vh"}},[t("global-header",{attrs:{collapsed:e.collapsed,device:e.device,menus:e.menus,mode:e.layoutMode,theme:e.navTheme},on:{toggle:e.toggle}}),t("a-layout-content",{style:{height:"100%",margin:"24px 24px 0",paddingTop:e.fixedHeader?"64px":"0"}},[t("transition",{attrs:{name:"page-transition"}},[t("route-view")],1)],1),t("a-layout-footer",[t("global-footer")],1)],1),t("setting-drawer",{ref:"drawer"}),t("LoginModal",{on:{success:e.onLoginSucceed}})],1)},h=[],p=a(84722),f=a(20629),g=a(3775),v=a(15899),y=a(45695),b={name:"RouteView",props:{keepAlive:{type:Boolean,default:!0}},data(){return{}},render(){const e=arguments[0],{$route:{meta:t}}=this,a=e("keep-alive",[e("router-view")]),n=e("router-view");return!1===t.keepAlive?n:this.keepAlive||t.keepAlive?a:n}},S=b,x=(0,d.Z)(S,n,i,!1,null,null,null),_=x.exports,k=function(){var e=this,t=e._self._c;return t("a-layout-sider",{class:["sider",e.isDesktop()?null:"shadow",e.theme,e.fixedSidebar?"ant-fixed-sidemenu":null],attrs:{collapsible:e.collapsible,trigger:null,width:"256px"},model:{value:e.collapsed,callback:function(t){e.collapsed=t},expression:"collapsed"}},[t("logo"),t("s-menu",{staticStyle:{padding:"16px 0px"},attrs:{collapsed:e.collapsed,menu:e.menus,mode:e.mode,theme:e.theme},on:{select:e.onSelect}})],1)},C=[],T=function(){var e=this,t=e._self._c;return t("div",{staticClass:"logo"},[t("img",{staticClass:"select-none cursor-pointer hover:brightness-125 transition-all",style:{width:e.sidebarOpened?"100px":"64px"},attrs:{alt:"Halo-Plus Logo",src:"/images/logo.svg"},on:{click:function(t){return e.onLogoClick()}}})])},E=[],w=(a(57658),a(73541)),L=a(93096),I=a.n(L),j={name:"Logo",mixins:[g.jB],data(){return{clickCount:0}},computed:{...(0,f.Se)(["options"])},methods:{...(0,f.nv)(["refreshOptionsCache"]),onLogoClick:I()((async function(){if(this.clickCount++,10!==this.clickCount)this.clickCount>=5&&(this.options.developer_mode?(this.$message.info("当前已启用开发者选项！"),this.clickCount=0):this.$message.info(`再点击 ${10-this.clickCount} 次即可启用开发者选项！`));else try{await w.Z.option.saveMapView({developer_mode:!0}),await this.refreshOptionsCache(),this.$message.success("开发者选项已启用！"),this.clickCount=0,this.$router.push({name:"ToolList"}).catch((()=>{}))}catch(e){this.$log.error(e)}}),200)}},O=j,A=(0,d.Z)(O,T,E,!1,null,null,null),Z=A.exports,P=a(36568),H=a.n(P),$=a(17001),M=a(62746),D={name:"SMenu",props:{menu:{type:Array,required:!0},theme:{type:String,required:!1,default:"dark"},mode:{type:String,required:!1,default:"inline"},collapsed:{type:Boolean,required:!1,default:!1}},data(){return{openKeys:[],selectedKeys:[],cachedOpenKeys:[]}},computed:{rootSubmenuKeys:e=>{const t=[];return e.menu.forEach((e=>t.push(e.path))),t}},created(){this.updateMenu()},watch:{collapsed(e){e?(this.cachedOpenKeys=this.openKeys.concat(),this.openKeys=[]):this.openKeys=this.cachedOpenKeys},$route:function(){this.updateMenu()}},methods:{onOpenChange(e){if("horizontal"===this.mode)return void(this.openKeys=e);const t=e.find((e=>!this.openKeys.includes(e)));this.rootSubmenuKeys.includes(t)?this.openKeys=t?[t]:[]:this.openKeys=e},onSelect({item:e,key:t,selectedKeys:a}){this.selectedKeys=a,this.$emit("select",{item:e,key:t,selectedKeys:a})},updateMenu(){const e=this.$route.matched.concat();e.length>=4&&this.$route.meta.hidden?(e.pop(),this.selectedKeys=[e[2].path]):this.selectedKeys=[e.pop().path];const t=[];"inline"===this.mode&&e.forEach((e=>{t.push(e.path)})),this.collapsed?this.cachedOpenKeys=t:this.openKeys=t},renderItem(e){return e.hidden?null:e.children&&!e.hideChildrenInMenu?this.renderSubMenu(e):this.renderMenuItem(e)},renderMenuItem(e){const t=this.$createElement,a=e.meta.target||null,n=a?"a":"router-link",i={to:{name:e.name}},s={href:"#"+e.path,target:e.meta.target};return t($.ZP.Item,H()([{},{key:e.path}]),[t(n,{props:{...i},attrs:{...s}},[this.renderIcon(e.meta.icon),t("span",[e.meta.title])])])},renderSubMenu(e){const t=this.$createElement,a=[];return e.hideChildrenInMenu||e.children.forEach((e=>a.push(this.renderItem(e)))),t($.ZP.SubMenu,H()([{},{key:e.path}]),[t("span",{slot:"title"},[this.renderIcon(e.meta.icon),t("span",[e.meta.title])]),a])},renderIcon(e){const t=this.$createElement;if("none"===e||void 0===e)return null;const a={};return"object"===typeof e?a.component=e:a.type=e,t(M.Z,{props:{...a}})}},render(){const e=arguments[0],t={props:{mode:this.mode,theme:this.theme,openKeys:this.openKeys,selectedKeys:this.selectedKeys},on:{openChange:this.onOpenChange,select:this.onSelect}},a=this.menu.map((e=>e.hidden?null:this.renderItem(e)));return e($.ZP,H()([{},t]),[a])}},F=D,N={name:"SideMenu",components:{Logo:Z,SMenu:F},mixins:[g.jB,g.KT],props:{mode:{type:String,required:!1,default:"inline"},theme:{type:String,required:!1,default:"dark"},collapsible:{type:Boolean,required:!1,default:!1},collapsed:{type:Boolean,required:!1,default:!1},menus:{type:Array,required:!0}},methods:{onSelect(e){this.$emit("menuSelect",e)}}},R=N,B=(0,d.Z)(R,k,C,!1,null,null,null),U=B.exports,G=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"showHeader"}},[e.visible?t("a-layout-header",{class:[e.fixedHeader&&"ant-header-fixedHeader",e.sidebarOpened?"ant-header-side-opened":"ant-header-side-closed"],staticStyle:{padding:"0"}},["sidemenu"===e.mode?t("div",{staticClass:"header"},["mobile"===e.device?t("a-icon",{staticClass:"trigger",attrs:{type:e.collapsed?"menu-fold":"menu-unfold"},on:{click:e.toggle}}):t("a-icon",{staticClass:"trigger",attrs:{type:e.collapsed?"menu-unfold":"menu-fold"},on:{click:e.toggle}}),t("user-menu")],1):t("div",{class:["top-nav-header-index",e.theme]},[t("div",{staticClass:"header-index-wide"},[t("div",{staticClass:"header-index-left"},["mobile"!==e.device?t("logo",{staticClass:"top-nav-header"}):e._e(),"mobile"!==e.device?t("s-menu",{attrs:{menu:e.menus,theme:e.theme,mode:"horizontal"}}):t("a-icon",{staticClass:"trigger",attrs:{type:e.collapsed?"menu-fold":"menu-unfold"},on:{click:e.toggle}})],1),t("user-menu",{staticClass:"header-index-right"})],1)])]):e._e()],1)},V=[],K=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-wrapper"},[t("a",{attrs:{href:e.options.blog_url,target:"_blank"}},[t("a-tooltip",{attrs:{placement:"bottom",title:"点击跳转到首页"}},[t("span",{staticClass:"action"},[t("a-icon",{attrs:{type:"link"}})],1)])],1),t("a",{attrs:{href:"javascript:void(0)"},on:{click:e.handleShowLayoutSetting}},[t("a-tooltip",{attrs:{placement:"bottom",title:"后台布局设置"}},[t("span",{staticClass:"action"},[t("a-icon",{attrs:{type:"setting"}})],1)])],1),t("header-comment",{staticClass:"action"}),t("a-dropdown",[e.user?t("span",{staticClass:"action ant-dropdown-link user-dropdown-menu"},[t("a-avatar",{staticClass:"avatar",attrs:{src:e.user.avatar||"//cn.gravatar.com/avatar/?s=256&d=mm",size:"small"}})],1):e._e(),t("a-menu",{staticClass:"user-dropdown-menu-wrapper",attrs:{slot:"overlay"},slot:"overlay"},[t("a-menu-item",{key:"0"},[t("router-link",{attrs:{to:{name:"Profile"}}},[t("a-icon",{attrs:{type:"user"}}),t("span",[e._v("个人资料")])],1)],1),t("a-menu-divider"),t("a-menu-item",{key:"1"},[t("a",{attrs:{href:"javascript:void(0);"},on:{click:e.handleLogout}},[t("a-icon",{attrs:{type:"logout"}}),t("span",[e._v("退出登录")])],1)])],1)],1)],1)},z=[],Y=function(){var e=this,t=e._self._c;return t("a-popover",{attrs:{arrowPointAtCenter:!0,autoAdjustOverflow:!0,overlayStyle:{width:"400px",top:"50px"},overlayClassName:"header-comment-popover",placement:"bottomRight",title:"待审核评论",trigger:"click"},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",{staticClass:"custom-tab-wrapper"},[t("a-tabs",{attrs:{animated:{inkBar:!0,tabPane:!1}},on:{change:e.handleListAuditingComments},model:{value:e.activeKey,callback:function(t){e.activeKey=t},expression:"activeKey"}},e._l(e.targets,(function(a){return t("a-tab-pane",{key:a.key,attrs:{tab:a.label}},[t("CommentListView",{attrs:{comments:e.comments[a.dataKey],loading:e.comments.loading,clickable:""},on:{click:function(t){return e.handleRouteToCommentList(arguments[0],a)}}})],1)})),1)],1)]},proxy:!0}])},[t("span",{staticClass:"inline-block transition-all"},[e.comments.post.length||e.comments.sheet.length||e.comments.journal.length?t("a-badge",{attrs:{dot:""}},[t("a-icon",{attrs:{type:"bell"}})],1):t("a-badge",[t("a-icon",{attrs:{type:"bell"}})],1)],1)])},q=[],W=a(10438);const X=[{key:"posts",dataKey:"post",label:"文章"},{key:"sheets",dataKey:"sheet",label:"页面"},{key:"journals",dataKey:"journal",label:"日志"}];var J={name:"HeaderComment",data(){return{targets:X,activeKey:"posts",comments:{post:[],sheet:[],journal:[],loading:!1}}},created(){this.handleListAuditingComments()},methods:{async handleListAuditingComments(){try{this.comments.loading=!0;const e={status:"AUDITING",size:20},t=await Promise.all(X.map((t=>w.Z.comment.list(t.key,e))));this.comments.post=t[0].data.content,this.comments.sheet=t[1].data.content,this.comments.journal=t[2].data.content}catch(e){this.$log.error("Failed to get auditing comments",e)}finally{this.comments.loading=!1}},handleRouteToCommentList(e,t){this.$log.debug("Handle click auditing comment",e,t);const{name:a}=this.$router.currentRoute;this.$router.push({name:"Comments",query:{activeKey:t.dataKey,defaultStatus:W.v$.AUDITING.value}}),"Comments"===a&&this.$router.go(0)}}},Q=J,ee=(0,d.Z)(Q,Y,q,!1,null,null,null),te=ee.exports,ae={name:"UserMenu",components:{HeaderComment:te},computed:{...(0,f.Se)(["user","options"])},methods:{...(0,f.nv)(["logout","ToggleLayoutSetting"]),handleLogout(){const e=this;this.$confirm({title:"提示",content:"确定要注销登录吗 ?",onOk:async()=>{try{await e.logout(),window.location.reload()}catch(t){e.$message.error({title:"错误",description:t.message})}}})},handleShowLayoutSetting(){this.ToggleLayoutSetting(!0)}}},ne=ae,ie=(0,d.Z)(ne,K,z,!1,null,null,null),se=ie.exports,oe={name:"GlobalHeader",components:{UserMenu:se,SMenu:F,Logo:Z},mixins:[g.jB],props:{mode:{type:String,default:"sidemenu"},menus:{type:Array,required:!0},theme:{type:String,required:!1,default:"dark"},collapsed:{type:Boolean,required:!1,default:!1},device:{type:String,required:!1,default:"desktop"}},data(){return{visible:!0,oldScrollTop:0}},mounted(){document.addEventListener("scroll",this.handleScroll,{passive:!0})},methods:{handleScroll(){if(!this.autoHideHeader)return;const e=document.body.scrollTop+document.documentElement.scrollTop;this.ticking||(this.ticking=!0,requestAnimationFrame((()=>{this.oldScrollTop>e?this.visible=!0:e>300&&this.visible?this.visible=!1:e<300&&!this.visible&&(this.visible=!0),this.oldScrollTop=e,this.ticking=!1})))},toggle(){this.$emit("toggle")}},beforeDestroy(){document.body.removeEventListener("scroll",this.handleScroll,!0)}},le=oe,re=(0,d.Z)(le,G,V,!1,null,null,null),de=re.exports,ce=de,ue=function(){var e=this,t=e._self._c;return t("div",{staticClass:"footer text-center",staticStyle:{padding:"0 16px",margin:"48px 0 0"}},[t("div",{staticClass:"copyright",staticStyle:{color:"rgba(0, 0, 0, 0.45)","font-size":"14px"}},[e._v(" Powered by "),t("router-link",{attrs:{to:{name:"About"}}},[e._v(" Halo-Plus ")])],1)])},me=[],he={name:"GlobalFooter"},pe=he,fe=(0,d.Z)(pe,ue,me,!1,null,null,null),ge=fe.exports,ve=ge,ye=function(){var e=this,t=e._self._c;return t("div",{ref:"settingDrawer",staticClass:"setting-drawer"},[t("a-drawer",{attrs:{visible:e.layoutSetting,closable:"",width:"300"},on:{close:e.onClose}},[t("div",{staticClass:"setting-drawer-index-content"},[t("div",{staticClass:"mb-6"},[t("h3",{staticClass:"setting-drawer-index-title"},[e._v("整体风格设置")]),t("div",{staticClass:"setting-drawer-index-blockChecbox"},[t("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("暗色菜单风格")]},proxy:!0}])},[t("div",{staticClass:"setting-drawer-index-item",on:{click:function(t){return e.handleSetMenuTheme("dark")}}},[t("img",{attrs:{alt:"dark",src:"/images/dark.svg"}}),"dark"===e.navTheme?t("div",{staticClass:"setting-drawer-index-selectIcon"},[t("a-icon",{attrs:{type:"check"}})],1):e._e()])]),t("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("亮色菜单风格")]},proxy:!0}])},[t("div",{staticClass:"setting-drawer-index-item",on:{click:function(t){return e.handleSetMenuTheme("light")}}},[t("img",{attrs:{alt:"light",src:"/images/light.svg"}}),"dark"!==e.navTheme?t("div",{staticClass:"setting-drawer-index-selectIcon"},[t("a-icon",{attrs:{type:"check"}})],1):e._e()])])],1)]),t("a-divider"),t("div",{staticClass:"mb-6"},[t("h3",{staticClass:"setting-drawer-index-title"},[e._v("主题色")]),t("div",{staticClass:"h-5"},e._l(e.colorList,(function(a,n){return t("a-tooltip",{key:n,staticClass:"setting-drawer-theme-color-colorBlock",scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(a.key))]},proxy:!0}],null,!0)},[t("a-tag",{attrs:{color:a.color},on:{click:function(t){return e.handleChangeColor(a.color)}}},[a.color===e.primaryColor?t("a-icon",{attrs:{type:"check"}}):e._e()],1)],1)})),1)]),t("a-divider"),t("div",{staticClass:"mb-6"},[t("h3",{staticClass:"setting-drawer-index-title"},[e._v("导航模式")]),t("div",{staticClass:"setting-drawer-index-blockChecbox"},[t("div",{staticClass:"setting-drawer-index-item",on:{click:function(t){return e.handleSetLayout("sidemenu")}}},[t("img",{attrs:{alt:"sidemenu",src:"/images/sidemenu.svg"}}),"sidemenu"===e.layoutMode?t("div",{staticClass:"setting-drawer-index-selectIcon"},[t("a-icon",{attrs:{type:"check"}})],1):e._e()]),t("div",{staticClass:"setting-drawer-index-item",on:{click:function(t){return e.handleSetLayout("topmenu")}}},[t("img",{attrs:{alt:"topmenu",src:"/images/topmenu.svg"}}),"sidemenu"!==e.layoutMode?t("div",{staticClass:"setting-drawer-index-selectIcon"},[t("a-icon",{attrs:{type:"check"}})],1):e._e()])])]),t("a-divider"),t("div",{staticClass:"mt-6"},[t("a-list",{attrs:{split:!1}},[t("a-list-item",{scopedSlots:e._u([{key:"actions",fn:function(){return[t("a-tooltip",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" 该设定仅 [顶部栏导航] 时有效")]},proxy:!0}])},[t("a-select",{staticStyle:{width:"80px"},attrs:{disabled:"topmenu"!==e.layoutMode,value:e.contentWidth,size:"small"},on:{change:e.handleContentWidthChange}},[t("a-select-option",{attrs:{value:"Fixed"}},[e._v("固定")]),"sidemenu"!==e.layoutMode?t("a-select-option",{attrs:{value:"Fluid"}},[e._v("流式")]):e._e()],1)],1)]},proxy:!0}])},[t("a-list-item-meta",{scopedSlots:e._u([{key:"title",fn:function(){return[t("div",[e._v("内容区域宽度")])]},proxy:!0}])})],1),t("a-list-item",{scopedSlots:e._u([{key:"actions",fn:function(){return[t("a-switch",{attrs:{checked:e.fixedHeader,size:"small"},on:{change:e.handleSetFixedHeader}})]},proxy:!0}])},[t("a-list-item-meta",{scopedSlots:e._u([{key:"title",fn:function(){return[t("div",[e._v("固定 Header")])]},proxy:!0}])})],1),t("a-list-item",{scopedSlots:e._u([{key:"actions",fn:function(){return[t("a-switch",{attrs:{checked:e.autoHideHeader,disabled:!e.fixedHeader,size:"small"},on:{change:e.handleSetAutoHideHeader}})]},proxy:!0}])},[t("a-list-item-meta",{scopedSlots:e._u([{key:"title",fn:function(){return[t("a-tooltip",{attrs:{placement:"left"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v("固定 Header 时可配置")]},proxy:!0}])},[t("div",{style:{opacity:e.fixedHeader?"1":"0.5"}},[e._v("下滑时隐藏 Header")])])]},proxy:!0}])})],1),t("a-list-item",{scopedSlots:e._u([{key:"actions",fn:function(){return[t("a-switch",{attrs:{checked:e.fixedSidebar,disabled:"topmenu"===e.layoutMode,size:"small"},on:{change:e.handleSetFixedSidebar}})]},proxy:!0}])},[t("a-list-item-meta",{scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{style:{opacity:"topmenu"===e.layoutMode?"0.5":"1"}},[e._v("固定侧边菜单")])]},proxy:!0}])})],1)],1)],1),t("a-divider")],1)])],1)},be=[];const Se=[{key:"红色",color:"#F5222D"},{key:"浅红色",color:"#FA541C"},{key:"日暮",color:"#FAAD14"},{key:"青色",color:"#13C2C2"},{key:"绿色",color:"#52C41A"},{key:"默认",color:"#1890FF"},{key:"蓝色",color:"#2F54EB"},{key:"紫色",color:"#722ED1"}];var xe=a(37208),_e=a.n(xe),ke=a(24778),Ce=a.n(ke),Te=a(61446);const Ee={getAntdSerials(e){const t=new Array(9).fill().map(((t,a)=>_e().varyColor.lighten(e,a/10))),a=Ce()(e),n=_e().varyColor.toNum3(e.replace("#","")).join(",");return t.concat(a).concat(n)},changeColor(e){const t={newColors:this.getAntdSerials(e),changeUrl(e){return`/${e}`}};return _e().changer.changeColor(t,Promise)}},we=e=>{const t=Te.Z.loading("正在切换主题",0);Ee.changeColor(e).then((()=>{t()}))};var Le={mixins:[g.jB,g.KT],data(){return{colorList:Se,baseConfig:Object.assign({},v.Z)}},watch:{},mounted(){this.primaryColor!==v.Z.primaryColor&&we(this.primaryColor)},computed:{...(0,f.Se)(["layoutSetting"])},methods:{...(0,f.nv)(["setSidebar","ToggleLayoutSetting"]),onClose(){this.ToggleLayoutSetting(!1)},handleSetMenuTheme(e){this.baseConfig.navTheme=e,this.$store.dispatch("ToggleTheme",e)},handleSetLayout(e){this.baseConfig.layout=e,this.$store.dispatch("ToggleLayoutMode",e),"sidemenu"===e?(this.handleContentWidthChange("Fixed"),this.handleSetFixedSidebar(!0)):(this.handleSetFixedHeader(!0),this.handleSetFixedSidebar(!1),this.$store.dispatch("setSidebar",!0))},handleContentWidthChange(e){this.baseConfig.contentWidth=e,this.$store.dispatch("ToggleContentWidth",e)},handleChangeColor(e){this.baseConfig.primaryColor=e,this.primaryColor!==e&&(this.$store.dispatch("ToggleColor",e),we(e))},handleSetFixedHeader(e){this.baseConfig.fixedHeader=e,this.$store.dispatch("ToggleFixedHeader",e),e||this.handleSetAutoHideHeader(!1)},handleSetAutoHideHeader(e){this.baseConfig.autoHideHeader=e,this.$store.dispatch("ToggleFixedHeaderHidden",e)},handleSetFixedSidebar(e){this.baseConfig.fixedSidebar=e,this.$store.dispatch("ToggleFixedSidebar",e)}}},Ie=Le,je=(0,d.Z)(Ie,ye,be,!1,null,"0512f470",null),Oe=je.exports,Ae=function(){var e=this,t=e._self._c;return t("div",[t("a-modal",{attrs:{footer:null,maskClosable:!1,width:320,title:"重新登录"},on:{cancel:e.handleCancelLogin},model:{value:e.loginModal,callback:function(t){e.loginModal=t},expression:"loginModal"}},[t("LoginForm",{on:{success:e.onLoginSucceed}})],1)],1)},Ze=[],Pe=a(11322),He={name:"LoginModal",components:{LoginForm:Pe.Z},computed:{...(0,f.Se)(["loginModal"])},methods:{...(0,f.nv)(["ToggleLoginModal"]),onLoginSucceed(){this.$emit("success")},handleCancelLogin(){this.ToggleLoginModal(!1)}}},$e=He,Me=(0,d.Z)($e,Ae,Ze,!1,null,"3ad442b9",null),De=Me.exports,Fe={name:"BasicLayout",mixins:[g.jB,g.KT],components:{RouteView:_,SideMenu:U,GlobalHeader:ce,GlobalFooter:ve,SettingDrawer:Oe,LoginModal:De},data(){return{production:v.Z.production,collapsed:!1,menus:[]}},computed:{contentPaddingLeft(){return!this.fixedSidebar||this.isMobile()?"0":this.sidebarOpened?"256px":"80px"}},watch:{sidebarOpened(e){this.collapsed=!e}},created(){this.menus=y.j.find((e=>"/"===e.path)).children,this.collapsed=!this.sidebarOpened},mounted(){const e=navigator.userAgent;e.indexOf("Edge")>-1&&this.$nextTick((()=>{this.collapsed=!this.collapsed,setTimeout((()=>{this.collapsed=!this.collapsed}),16)}))},methods:{...(0,f.nv)(["setSidebar","ToggleLoginModal"]),toggle(){this.collapsed=!this.collapsed,this.setSidebar(!this.collapsed),(0,p.XC)()},menuSelect(){this.isDesktop()||(this.collapsed=!1)},drawerClose(){this.collapsed=!1},onLoginSucceed(){this.ToggleLoginModal(!1)}}},Ne=Fe,Re=(0,d.Z)(Ne,m,h,!1,null,null,null),Be=Re.exports,Ue=function(){var e=this,t=e._self._c;return t("div",{style:e.$route.meta.hiddenHeaderContent?null:"margin: -24px -24px 0px;"},[e.affix?t("a-affix",[e.$route.meta.hiddenHeaderContent?e._e():t("div",{staticClass:"page-header"},[t("div",{staticClass:"page-header-index-wide"},[t("a-page-header",{attrs:{breadcrumb:{props:{routes:e.breadList}},"sub-title":e.subTitle,title:e.title}},[e._t("extra",null,{slot:"extra"}),e._t("footer",null,{slot:"footer"}),e._t("content")],2)],1)])]):e._e(),e.$route.meta.hiddenHeaderContent||e.affix?e._e():t("div",{staticClass:"page-header"},[t("div",{staticClass:"page-header-index-wide"},[t("a-page-header",{attrs:{breadcrumb:{props:{routes:e.breadList}},"sub-title":e.subTitle,title:e.title}},[e._t("extra",null,{slot:"extra"}),e._t("footer",null,{slot:"footer"}),e._t("content")],2)],1)]),t("div",{staticClass:"content"},[t("div",{staticClass:"page-header-index-wide"},[e._t("default",(function(){return[t("router-view",{ref:"content"})]}))],2)])],1)},Ge=[],Ve={name:"PageView",props:{title:{type:String,default:null},subTitle:{type:String,default:null},affix:{type:Boolean,default:!1}},data(){return{breadList:[]}},created(){this.getBreadcrumb()},watch:{$route(){this.getBreadcrumb()}},methods:{getBreadcrumb(){this.breadList=[],this.$route.matched.forEach((e=>{e.breadcrumbName=e.meta.title,this.breadList.push(e)}))}}},Ke=Ve,ze=(0,d.Z)(Ke,Ue,Ge,!1,null,"3af43504",null),Ye=ze.exports},57521:function(e,t,a){"use strict";var n=a(20144),i=function(){var e=this,t=e._self._c;return t("a-config-provider",{attrs:{locale:e.locale}},[t("div",{staticClass:"h-full",attrs:{id:"app"}},[t("router-view")],1)])},s=[],o=a(84041),l=a(80315),r={data(){return{locale:o.Z}},mounted(){const{$store:e}=this;(0,l.A)((t=>{switch(t){case l.m.DESKTOP:e.commit("TOGGLE_DEVICE","desktop"),e.dispatch("setSidebar",this.$store.getters.sidebar);break;case l.m.TABLET:e.commit("TOGGLE_DEVICE","tablet"),e.dispatch("setSidebar",this.$store.getters.sidebar);break;case l.m.MOBILE:default:e.commit("TOGGLE_DEVICE","mobile"),e.dispatch("setSidebar",!0);break}}))}},d=r,c=a(1001),u=(0,c.Z)(d,i,s,!1,null,null,null),m=u.exports,h=a(78345),p=a(45695);n["default"].use(h.ZP);var f=new h.ZP({mode:"hash",base:"/",scrollBehavior:()=>({y:0}),routes:p.k.concat(p.j)}),g=a(83299),v=a(86941),y=a(10101);const b=!0,S={isEnabled:!0,logLevel:b?"error":"debug",stringifyArguments:!1,showLogLevel:!0,showMethodName:!0,separator:"|",showConsoleColors:!0};n["default"].use(y.Z,S);var x=a(17287),_=a.n(x),k=a(15899),C=a(1910),T=a(3782),E=a(73051),w=a(45542),L=a(54464),I=a(12094),j=a(47346),O=a(63060),A=a(95878),Z=a(24741),P=a(36993),H=a(65494),$=a(23887),M=a(16987),D=a(96650),F=a(6723),N=a(57288),R=a(40726),B=a(62746),U=a(78929),G=a(5559),V=a(36511),K=a(70108),z=a(42594),Y=a(17001),q=a(45361),W=a(50091),X=a(87657),J=a(87204),Q=a(98704),ee=a(60469),te=a(40058),ae=a(24871),ne=a(17697),ie=a(97152),se=a(39744),oe=a(75381),le=a(2104),re=a(81741),de=a(75145),ce=a(45862),ue=a(54436),me=a(60333),he=a(41544),pe=a(66818),fe=a(16922),ge=a(773),ve=a(50724),ye=a(85263),be=a(97119),Se=a(97139),xe=a(64053),_e=a(61446),ke=a(70473);n["default"].use(C.Z),n["default"].use(T.ZP),n["default"].use(E.Z),n["default"].use(w.Z),n["default"].use(L.Z),n["default"].use(I.Z),n["default"].use(j.Z),n["default"].use(O.Z),n["default"].use(A.Z),n["default"].use(Z.Z),n["default"].use(P.Z),n["default"].use(H.Z),n["default"].use($.Z),n["default"].use(M.Z),n["default"].use(D.Z),n["default"].use(F.ZP),n["default"].use(N.ZP),n["default"].use(R.ZP),n["default"].use(B.Z),n["default"].use(U.Z),n["default"].use(G.Z),n["default"].use(V.Z),n["default"].use(K.ZP),n["default"].use(z.Z),n["default"].use(Y.ZP),n["default"].use(q.Z),n["default"].use(W.Z),n["default"].use(X.ZP),n["default"].use(J.Z),n["default"].use(Q.Z),n["default"].use(ee.Z),n["default"].use(te.ZP),n["default"].use(ae.Z),n["default"].use(ne.ZP),n["default"].use(ie.Z),n["default"].use(se.Z),n["default"].use(oe.Z),n["default"].use(le.Z),n["default"].use(re.ZP),n["default"].use(de.ZP),n["default"].use(ce.Z),n["default"].use(ue.ZP),n["default"].use(me.Z),n["default"].use(he.Z),n["default"].use(pe.Z),n["default"].use(fe.Z),n["default"].use(ge.ZP),n["default"].use(ve.Z),n["default"].use(ye.ZP),n["default"].use(be.ZP),n["default"].use(Se.ZP),n["default"].use(xe.ZP),_e.Z.config({maxCount:1}),n["default"].prototype.$message=_e.Z,n["default"].prototype.$notification=ke.Z,n["default"].prototype.$info=q.Z.info,n["default"].prototype.$success=q.Z.success,n["default"].prototype.$error=q.Z.error,n["default"].prototype.$warning=q.Z.warning,n["default"].prototype.$confirm=q.Z.confirm;a(76268);var Ce=a(28762);function Te(){v.Z.commit("SET_SIDEBAR_TYPE",n["default"].ls.get(Ce.mQ,!0)),v.Z.commit("TOGGLE_THEME",n["default"].ls.get(Ce.t0,k.Z.navTheme)),v.Z.commit("TOGGLE_LAYOUT_MODE",n["default"].ls.get(Ce.v9,k.Z.layout)),v.Z.commit("TOGGLE_FIXED_HEADER",n["default"].ls.get(Ce.Vv,k.Z.fixedHeader)),v.Z.commit("TOGGLE_FIXED_SIDEBAR",n["default"].ls.get(Ce.lK,k.Z.fixedSidebar)),v.Z.commit("TOGGLE_CONTENT_WIDTH",n["default"].ls.get(Ce.hC,k.Z.contentWidth)),v.Z.commit("TOGGLE_FIXED_HEADER_HIDDEN",n["default"].ls.get(Ce.NK,k.Z.autoHideHeader)),v.Z.commit("TOGGLE_COLOR",n["default"].ls.get(Ce.Dp,k.Z.primaryColor)),v.Z.commit("SET_TOKEN",n["default"].ls.get(Ce.LA)),v.Z.commit("SET_USER",n["default"].ls.get(Ce.xR)),v.Z.commit("SET_OPTIONS",n["default"].ls.get(Ce.JY))}var Ee=a(72268),we=a.n(Ee);n["default"].use(_(),k.Z.storageOptions),n["default"].use(we()),Te();var Le=a(74865),Ie=a.n(Le);const je=function(e){document.title=e;const t=navigator.userAgent,a=/\bMicroMessenger\/([\d\.]+)/;if(a.test(t)&&/ip(hone|od|ad)/i.test(t)){const e=document.createElement("iframe");e.src="/favicon.ico",e.style.display="none",e.onload=function(){setTimeout((function(){e.remove()}),9)},document.body.appendChild(e)}},Oe="Halo";Ie().configure({showSpinner:!1,speed:500});const Ae=["Login","Install","NotFound","ResetPassword"];let Ze=null;function Pe(){Ze&&0!==Ze&&(clearTimeout(Ze),Ze=null),Ie().done()}f.beforeEach((async(e,t,a)=>(Pe(),Ze=setTimeout((()=>{Ie().start()}),250),void 0===v.Z.getters.isInstalled&&await v.Z.dispatch("fetchIsInstalled"),v.Z.getters.isInstalled||(await v.Z.commit("SET_OPTIONS",void 0),await v.Z.commit("CLEAR_TOKEN"),await v.Z.commit("SET_USER",{})),v.Z.getters.isInstalled||"Install"===e.name?v.Z.getters.isInstalled&&"Install"===e.name?(a({name:"Login"}),void Pe()):v.Z.getters.token?(v.Z.getters.options||await v.Z.dispatch("refreshOptionsCache").then(),["Login","Install"].includes(e.name)?(a({name:"Dashboard"}),void Pe()):void a()):void(Ae.includes(e.name)?a():(a({name:"Login",query:{redirect:e.fullPath}}),Pe())):(a({name:"Install"}),void Pe())))),f.afterEach((e=>{e.meta&&"undefined"!==typeof e.meta.title&&je(`${e.meta.title} - ${Oe}`),Pe()}));var He=a(27484),$e=a.n(He),Me=(a(33852),a(48478)),De=a(87441);$e().locale("zh-cn"),n["default"].filter("moment",(function(e,t="YYYY-MM-DD HH:mm"){return $e()(e).format(t)})),n["default"].filter("moment_post_date",(function(e,t="/YYYY/MM/"){return $e()(e).format(t)})),n["default"].filter("moment_post_year",(function(e,t="/YYYY/"){return $e()(e).format(t)})),n["default"].filter("moment_post_day",(function(e,t="/YYYY/MM/DD/"){return $e()(e).format(t)})),n["default"].filter("timeAgo",Me.S),n["default"].filter("fileSizeFormat",(function(e){if(!e)return"0 Bytes";const t=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],a=parseFloat(e);let n=Math.floor(Math.log(a)/Math.log(1024)),i=a/Math.pow(1024,n);return i=i.toFixed(2),i+" "+t[n]})),n["default"].filter("dayTime",(function(e){const t=Math.floor(e/86400),a=Math.floor(e%86400/3600),n=Math.floor(e%86400%3600/60),i=Math.floor(e%86400%3600%60);return t+"d "+a+"h "+n+"m "+i+"s"})),n["default"].filter("markdownRender",(function(e){return De.TU.parse(e)}));const Fe=(e="")=>e.split("").reduce(((e,t)=>{const a=t.charCodeAt(0);return a>=0&&a<=128?e+1:e+2}),0),Ne=(e="",t)=>{let a=0;return e.split("").reduce(((e,n)=>{const i=n.charCodeAt(0);return a+=i>=0&&i<=128?1:2,a<=t?e+n:e}),"")};var Re,Be,Ue={name:"Ellipsis",components:{Tooltip:me.Z},props:{prefixCls:{type:String,default:"ant-pro-ellipsis"},tooltip:{type:Boolean},length:{type:Number,required:!0},lines:{type:Number,default:1},fullWidthRecognition:{type:Boolean,default:!1}},methods:{getStrDom(e,t){const a=this.$createElement;return a("span",[Ne(e,this.length)+(t>this.length?"...":"")])},getTooltip(e,t){const a=this.$createElement;return a(me.Z,[a("template",{slot:"title"},[e]),this.getStrDom(e,t)])}},render(){const{tooltip:e,length:t}=this.$props,a=this.$slots.default.map((e=>e.text)).join(""),n=Fe(a);return e&&n>t?this.getTooltip(a,n):this.getStrDom(a,n)}},Ge=Ue,Ve=(0,c.Z)(Ge,Re,Be,!1,null,null,null),Ke=Ve.exports,ze=Ke,Ye=function(){var e=this,t=e._self._c;return t("div",{class:e.prefixCls},[t("div",{staticClass:"float-left"},[e._t("extra",(function(){return[e._v(e._s(e.extra))]}))],2),t("div",{staticClass:"float-right"},[e._t("default")],2)])},qe=[],We={name:"FooterToolBar",props:{prefixCls:{type:String,default:"ant-pro-footer-toolbar"},extra:{type:[String,Object],default:""}}},Xe=We,Je=(0,c.Z)(Xe,Ye,qe,!1,null,null,null),Qe=Je.exports,et=Qe,tt=function(){var e=this,t=e._self._c;return t("div",[t("file-pond",{ref:"pond",attrs:{"accepted-file-types":e.accepts,"allow-multiple":e.multiple,allowImagePreview:e.allowImagePreview,allowRevert:!1,files:e.fileList,"label-idle":e.label,maxFiles:e.maxFiles,maxParallelUploads:e.maxParallelUploads,name:e.name,server:e.server,fileValidateTypeLabelExpectedTypes:"请选择 {lastType} 格式的文件",labelFileProcessing:"上传中",labelFileProcessingAborted:"取消上传",labelFileProcessingComplete:"上传完成",labelFileProcessingError:"上传错误",labelFileTypeNotAllowed:"不支持当前文件格式",labelTapToCancel:"点击取消",labelTapToRetry:"点击重试"},on:{init:e.handleFilePondInit}})],1)},at=[],nt=a(20629),it=a(10308),st=a(61658),ot=a.n(st),lt=a(72965),rt=a.n(lt),dt=a(90521),ct=a.n(dt);const ut=ot()(rt(),ct());var mt={name:"FilePondUpload",components:{FilePond:ut},props:{name:{type:String,required:!1,default:"file"},field:{type:String,required:!1,default:""},multiple:{type:Boolean,required:!1,default:!0},accepts:{type:Array,required:!1,default:()=>null},label:{type:String,required:!1,default:"点击选择文件或将文件拖拽到此处"},uploadHandler:{type:Function,required:!0}},computed:{...(0,nt.Se)(["options"]),maxParallelUploads(){return this.options?this.options.attachment_upload_max_parallel_uploads:1},allowImagePreview(){return!!this.options&&this.options.attachment_upload_image_preview_enable},maxFiles(){return this.options?this.options.attachment_upload_max_files:1}},data:function(){return{server:{process:(e,t,a,n,i,s,o)=>{const l=it.Axios.CancelToken,r=l.source();return this.uploadHandler(t,{onUploadProgress:e=>{e.total>0&&s(e.lengthComputable,e.loaded,e.total)},cancelToken:r.token},this.field).then((e=>{n(e),this.$log.debug("Uploaded successfully",e),this.$emit("success",e,t)})).catch((e=>{this.$log.debug("Failed to upload file",e),this.$emit("failure",e,t),i()})),{abort:()=>{o(),this.$log.debug("Upload operation aborted by the user"),r.cancel("Upload operation canceled by the user.")}}}},fileList:[]}},methods:{handleFilePondInit(){this.$log.debug("FilePond has initialized")},handleClearFileList(){this.$refs.pond.removeFiles()}}},ht=mt,pt=(0,c.Z)(ht,tt,at,!1,null,null,null),ft=pt.exports,gt=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{afterClose:e.onClose,footer:null,destroyOnClose:"",title:"上传附件"},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[t("a-auto-complete",{staticClass:"auto-complete-team",staticStyle:{width:"100%","margin-bottom":"10px"},attrs:{dataSource:e.teams,placeholder:"请输入文件分组",allowClear:""},model:{value:e.team,callback:function(t){e.team=t},expression:"team"}}),t("FilePondUpload",{ref:"upload",attrs:{uploadHandler:e.uploadHandler}})],1)},vt=[],yt=a(73541),bt={name:"AttachmentUploadModal",props:{visible:{type:Boolean,default:!1},teams:{type:Array,default:()=>[]}},data(){return{uploadHandler:(e,t)=>yt.Z.attachment.upload(e,t,this.team),team:"默认分组"}},computed:{modalVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}}},methods:{onClose(){this.$refs.upload.handleClearFileList(),this.$emit("close")}}},St=bt,xt=(0,c.Z)(St,gt,vt,!1,null,null,null),_t=xt.exports,kt=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{afterClose:e.onAfterClose,title:e.title,width:1280,destroyOnClose:""},scopedSlots:e._u([{key:"footer",fn:function(){return[t("a-button",{on:{click:function(t){e.modalVisible=!1}}},[e._v("取消")]),t("a-button",{attrs:{disabled:!e.list.selected.length,type:"primary"},on:{click:e.handleConfirm}},[e._v("确定")])]},proxy:!0}]),model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[t("div",{staticClass:"table-page-search-wrapper"},[t("a-form",{attrs:{layout:"inline"}},[t("a-row",{attrs:{gutter:24}},[t("a-col",{attrs:{xxl:5,md:12,sm:24}},[t("a-form-item",{attrs:{label:"关键词："}},[t("a-input",{on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch()}},model:{value:e.list.params.keyword,callback:function(t){e.$set(e.list.params,"keyword",t)},expression:"list.params.keyword"}})],1)],1),t("a-col",{attrs:{xxl:5,md:12,sm:24}},[t("a-form-item",{attrs:{label:"分组："}},[t("a-select",{attrs:{loading:e.teams.loading,allowClear:""},on:{change:function(t){return e.handleSearch()}},model:{value:e.list.params.team,callback:function(t){e.$set(e.list.params,"team",t)},expression:"list.params.team"}},e._l(e.teams.data,(function(a,n){return t("a-select-option",{key:n,attrs:{value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1)],1),t("a-col",{attrs:{xxl:5,md:8,sm:24}},[t("a-form-item",{attrs:{label:"存储位置："}},[t("a-select",{attrs:{loading:e.types.loading,allowClear:""},on:{change:function(t){return e.handleSearch()}},model:{value:e.list.params.attachmentType,callback:function(t){e.$set(e.list.params,"attachmentType",t)},expression:"list.params.attachmentType"}},e._l(e.types.data,(function(a){return t("a-select-option",{key:a,attrs:{value:a}},[e._v(" "+e._s(e._f("typeText")(a))+" ")])})),1)],1)],1),t("a-col",{attrs:{xxl:5,md:8,sm:24}},[t("a-form-item",{attrs:{label:"文件类型："}},[t("a-select",{attrs:{loading:e.mediaTypes.loading,allowClear:""},on:{change:function(t){return e.handleSearch()}},model:{value:e.list.params.mediaType,callback:function(t){e.$set(e.list.params,"mediaType",t)},expression:"list.params.mediaType"}},e._l(e.mediaTypes.data,(function(a,n){return t("a-select-option",{key:n,attrs:{value:a}},[e._v(" "+e._s(a)+" ")])})),1)],1)],1),t("a-col",{attrs:{xxl:5,md:8,sm:24}},[t("span",{staticClass:"table-page-search-submitButtons"},[t("a-space",[t("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSearch()}}},[e._v("查询")]),t("a-button",{on:{click:function(t){e.handleResetParam(),e.handleListAttachments()}}},[e._v("重置")])],1)],1)])],1)],1)],1),t("div",{staticClass:"table-operator mb-0"},[t("a-button",{attrs:{icon:"cloud-upload",type:"primary"},on:{click:function(t){e.upload.visible=!0}}},[e._v("上传")])],1),t("a-divider"),t("a-spin",{attrs:{spinning:e.list.loading}},[t("div",{staticClass:"grid grid-cols-2 gap-x-2 gap-y-3 sm:grid-cols-3 md:grid-cols-6 xl:grid-cols-8 2xl:grid-cols-10",attrs:{role:"list"}},e._l(e.list.data,(function(a,n){return t("div",{key:n,staticClass:"relative cursor-pointer overflow-hidden rounded-sm border-solid bg-white transition-all hover:shadow-sm",class:""+(e.isItemSelect(a)?"border-blue-600":"border-slate-200"),on:{click:function(t){return e.handleItemClick(a)},mouseenter:function(t){return e.$set(a,"hover",!0)},mouseleave:function(t){return e.$set(a,"hover",!1)}}},[t("div",{staticClass:"group aspect-w-10 aspect-h-7 block w-full overflow-hidden bg-white"},[e.isImage(a)?t("img",{staticClass:"pointer-events-none overflow-hidden object-cover transition-opacity group-hover:opacity-70",attrs:{alt:a.name,src:a.thumbPath,loading:"lazy"}}):t("span",{staticClass:"flex items-center justify-center text-2xl text-gray-600"},[e._v(" "+e._s(a.suffix)+" ")])]),t("a-tooltip",{attrs:{title:a.name}},[t("span",{staticClass:"block truncate p-1.5 text-xs font-medium text-gray-500"},[e._v(" "+e._s(a.name)+" ")])]),t("a-icon",{directives:[{name:"show",rawName:"v-show",value:e.isItemSelect(a)&&!a.hover,expression:"isItemSelect(attachment) && !attachment.hover"}],staticClass:"absolute top-1 right-1 cursor-pointer font-bold transition-all",style:{fontSize:"20px",color:"rgb(37 99 235)"},attrs:{theme:"twoTone",type:"check-circle"}}),t("a-icon",{directives:[{name:"show",rawName:"v-show",value:a.hover,expression:"attachment.hover"}],staticClass:"absolute top-1 right-1 cursor-pointer font-bold transition-all",style:{fontSize:"20px"},attrs:{theme:"twoTone",type:"profile"},on:{click:function(t){return t.stopPropagation(),e.handleOpenDetail(a)}}})],1)})),0)]),t("div",{staticClass:"mt-4 flex justify-between"},[t("a-popover",{attrs:{placement:"right",title:"预览",trigger:"click"}},[t("template",{slot:"content"},[e.list.selected.length?t("a-tabs",{attrs:{"default-active-key":"markdown","tab-position":"left"}},[t("a-tab-pane",{key:"markdown",attrs:{tab:"Markdown"}},[t("div",{staticClass:"text-slate-400",domProps:{innerHTML:e._s(e.markdownSyntaxList.join("<br />"))}})]),t("a-tab-pane",{key:"html",attrs:{"force-render":"",tab:"HTML"}},[t("div",{staticClass:"text-slate-400"},e._l(e.htmlSyntaxList,(function(a,n){return t("span",{key:n,staticClass:"text-slate-400"},[e._v(" "+e._s(a)),t("br")])})),0)])],1):t("div",{staticClass:"text-slate-400"},[e._v("未选择附件")])],1),t("a-tooltip",{attrs:{placement:"top",title:"点击预览"}},[t("div",{staticClass:"cursor-pointer select-none self-center text-slate-400 transition-all hover:text-blue-400"},[e._v(" 已选择 "+e._s(e.list.selected.length)+" 项 ")])])],2),t("div",{staticClass:"page-wrapper flex justify-end self-center"},[t("a-pagination",{staticClass:"pagination !mt-0",attrs:{current:e.pagination.page,defaultPageSize:e.pagination.size,pageSizeOptions:["40","50","100","150","200"],total:e.pagination.total,showLessItems:"",showSizeChanger:""},on:{change:e.handlePageChange,showSizeChange:e.handlePageSizeChange}})],1)],1),t("AttachmentUploadModal",{attrs:{visible:e.upload.visible,teams:e.teams.data},on:{"update:visible":function(t){return e.$set(e.upload,"visible",t)},close:e.handleSearch}}),t("AttachmentDetailModal",{attrs:{attachment:e.list.current,teams:e.teams.data,visible:e.detailVisible},on:{"update:visible":function(t){e.detailVisible=t},delete:function(t){return e.handleListAttachments()}},scopedSlots:e._u([{key:"extraFooter",fn:function(){return[t("a-button",{attrs:{disabled:e.selectPreviousButtonDisabled},on:{click:e.handleSelectPrevious}},[e._v("上一项")]),t("a-button",{attrs:{disabled:e.selectNextButtonDisabled},on:{click:e.handleSelectNext}},[e._v("下一项")]),t("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleItemClick(e.list.current)}}},[e._v(" "+e._s(e.list.selected.findIndex((t=>t.id===e.list.current.id))>-1?"取消选择":"选择")+" ")])]},proxy:!0}])})],1)},Ct=[],Tt=a(10438),Et={name:"AttachmentSelectModal",props:{visible:{type:Boolean,default:!1},title:{type:String,default:"选择附件"},multiSelect:{type:Boolean,default:!0}},data(){return{list:{data:[],total:0,hasNext:!1,hasPrevious:!1,loading:!1,params:{page:0,size:40,keyword:void 0,team:void 0,mediaType:void 0,attachmentType:void 0},selected:[],current:{}},teams:{data:[],loading:!1},mediaTypes:{data:[],loading:!1},types:{data:[],loading:!1},upload:{visible:!1},detailVisible:!1}},computed:{modalVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}},pagination(){return{page:this.list.params.page+1,size:this.list.params.size,total:this.list.total}},selectPreviousButtonDisabled(){const e=this.list.data.findIndex((e=>e.id===this.list.current.id));return 0===e&&!this.list.hasPrevious},selectNextButtonDisabled(){const e=this.list.data.findIndex((e=>e.id===this.list.current.id));return e===this.list.data.length-1&&!this.list.hasNext},isImage(){return function(e){return!(!e||!e.mediaType)&&e.mediaType.startsWith("image")}},isItemSelect(){return function(e){return this.list.selected.findIndex((t=>t.id===e.id))>-1}},markdownSyntaxList(){return this.list.selected.length?this.list.selected.map((e=>`![${e.name}](${e.path})`)):[]},htmlSyntaxList(){return this.list.selected.length?this.list.selected.map((e=>`<img src="${e.path}" alt="${e.name}">`)):[]}},watch:{modalVisible(e){e&&(this.handleListAttachments(),this.handleListTeams(),this.handleListMediaTypes(),this.handleListTypes())}},methods:{async handleListAttachments(){try{this.list.loading=!0;const e=await yt.Z.attachment.list(this.list.params);this.list.data=e.data.content,this.list.total=e.data.total,this.list.hasNext=e.data.hasNext,this.list.hasPrevious=e.data.hasPrevious}catch(e){this.$log.error(e)}finally{this.list.loading=!1}},async handleListTeams(){try{this.teams.loading=!0;const e=await yt.Z.attachment.listTeams();this.teams.data=e.data.filter((e=>!!e))}catch(e){this.$log.error(e)}finally{this.teams.loading=!1}},async handleListMediaTypes(){try{this.mediaTypes.loading=!0;const e=await yt.Z.attachment.listMediaTypes();this.mediaTypes.data=e.data}catch(e){this.$log.error(e)}finally{this.mediaTypes.loading=!1}},async handleListTypes(){try{this.types.loading=!0;const e=await yt.Z.attachment.listTypes();this.types.data=e.data}catch(e){this.$log.error(e)}finally{this.types.loading=!1}},handlePageChange(e=1){this.list.params.page=e-1,this.handleListAttachments()},handleSearch(){this.handlePageChange(1)},handleResetParam(){this.list.params={page:0,size:40,keyword:void 0,teams:void 0,mediaType:void 0,attachmentType:void 0}},handlePageSizeChange(e,t){this.$log.debug(`Current: ${e}, PageSize: ${t}`),this.list.params.page=0,this.list.params.size=t,this.handleListAttachments()},handleItemClick(e){if(!this.multiSelect)return this.$emit("confirm",{raw:[e],markdown:[`![${e.name}](${e.path})`],html:[`<img src="${e.path}" alt="${e.name}">`]}),void(this.modalVisible=!1);const t=this.list.selected.findIndex((t=>t.id===e.id))>-1;t?this.handleUnselect(e):this.handleSelect(e)},handleSelect(e){this.list.selected=[...this.list.selected,e]},handleUnselect(e){this.list.selected=this.list.selected.filter((t=>t.id!==e.id))},handleConfirm(){this.$emit("confirm",{raw:this.list.selected,markdown:this.markdownSyntaxList,html:this.htmlSyntaxList}),this.modalVisible=!1},handleOpenDetail(e){this.list.current=e,this.detailVisible=!0},async handleSelectPrevious(){const e=this.list.data.findIndex((e=>e.id===this.list.current.id));e>0?this.list.current=this.list.data[e-1]:0===e&&this.list.hasPrevious&&(this.list.params.page--,await this.handleListAttachments(),this.list.current=this.list.data[this.list.data.length-1])},async handleSelectNext(){const e=this.list.data.findIndex((e=>e.id===this.list.current.id));e<this.list.data.length-1?this.list.current=this.list.data[e+1]:e===this.list.data.length-1&&this.list.hasNext&&(this.list.params.page++,await this.handleListAttachments(),this.list.current=this.list.data[0])},onAfterClose(){this.handleResetParam(),this.list.selected=[]}},filters:{typeText(e){return Tt.k[e].text}}},wt=Et,Lt=(0,c.Z)(wt,kt,Ct,!1,null,null,null),It=Lt.exports,jt=function(){var e=this,t=e._self._c;return t("a-modal",{attrs:{width:e.isMobile()?"100%":"50%",title:"附件详情"},scopedSlots:e._u([{key:"footer",fn:function(){return[e._t("extraFooter"),t("a-popconfirm",{attrs:{cancelText:"取消",okText:"确定",title:"你确定要删除该附件？"},on:{confirm:e.handleDelete}},[t("ReactiveButton",{attrs:{errored:e.deleteErrored,loading:e.deleting,erroredText:"删除失败",icon:"delete",loadedText:"删除成功",text:"删除",type:"danger"},on:{callback:e.handleDeletedCallback}})],1)]},proxy:!0}],null,!0),model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[t("a-row",{attrs:{gutter:24,type:"flex"}},[t("a-col",{attrs:{lg:9,md:24,sm:24,xl:9,xs:24}},[t("div",{staticClass:"attach-detail-img pb-3"},[e.isImage?t("a",{attrs:{href:e.attachment.path,target:"_blank"}},[t("img",{staticClass:"w-full",attrs:{src:e.attachment.path,loading:"lazy"}})]):t("div",[e._v("此文件不支持预览")])])]),t("a-col",{attrs:{lg:15,md:24,sm:24,xl:15,xs:24}},[t("a-list",{attrs:{itemLayout:"horizontal"}},[t("a-list-item",{staticStyle:{"padding-top":"0"}},[t("a-list-item-meta",[e.nameEditable?t("template",{slot:"description"},[t("a-input",{ref:"nameInput",on:{blur:e.handleUpdateName},model:{value:e.attachment.name,callback:function(t){e.$set(e.attachment,"name",t)},expression:"attachment.name"}})],1):t("template",{slot:"description"},[e._v(e._s(e.attachment.name))]),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" 附件名： "),t("a-button",{staticClass:"!p-0",attrs:{type:"link"},on:{click:e.handleEditName}},[t("a-icon",{attrs:{type:"edit"}})],1)],1)],2)],1),t("a-list-item",[t("a-list-item-meta",[e.teamEditable?t("template",{slot:"description"},[t("a-auto-complete",{ref:"teamInput",staticStyle:{width:"100%",overflow:"hidden"},attrs:{dataSource:e.teams,allowClear:""},on:{blur:e.handleUpdateTeam},model:{value:e.attachment.team,callback:function(t){e.$set(e.attachment,"team",t)},expression:"attachment.team"}})],1):t("template",{slot:"description"},[e._v(e._s(e.attachment.team))]),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" 分组： "),t("a-button",{staticClass:"!p-0",attrs:{type:"link"},on:{click:e.handleEditTeam}},[t("a-icon",{attrs:{type:"edit"}})],1)],1)],2)],1),t("a-list-item",[t("a-list-item-meta",{attrs:{description:e.attachment.mediaType}},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v("附件类型：")])])],1),t("a-list-item",[t("a-list-item-meta",{attrs:{description:e._f("typeText")(e.attachment.type)}},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v("存储位置：")])])],1),t("a-list-item",[t("a-list-item-meta",[t("template",{slot:"description"},[e._v(" "+e._s(e._f("fileSizeFormat")(e.attachment.size))+" ")]),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("附件大小：")])],2)],1),e.isImage?t("a-list-item",[t("a-list-item-meta",{attrs:{description:e.attachment.height+"x"+e.attachment.width}},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v("图片尺寸：")])])],1):e._e(),t("a-list-item",[t("a-list-item-meta",[t("template",{slot:"description"},[e._v(" "+e._s(e._f("moment")(e.attachment.createTime))+" ")]),t("span",{attrs:{slot:"title"},slot:"title"},[e._v("上传日期：")])],2)],1),t("a-list-item",[t("a-list-item-meta",{scopedSlots:e._u([{key:"description",fn:function(){return[t("a",{attrs:{href:e.attachment.path,target:"_blank"}},[e._v(e._s(e.attachment.path))])]},proxy:!0}])},[t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" 普通链接： "),t("a-button",{staticClass:"!p-0",attrs:{type:"link"},on:{click:function(t){return e.handleCopyLink(`${e.attachment.path}`)}}},[t("a-icon",{attrs:{type:"copy"}})],1)],1)])],1),e.isImage?t("a-list-item",[t("a-list-item-meta",[t("span",{attrs:{slot:"description"},slot:"description"},[e._v("!["+e._s(e.attachment.name)+"]("+e._s(e.attachment.path)+")")]),t("span",{attrs:{slot:"title"},slot:"title"},[e._v(" Markdown 格式： "),t("a-button",{staticClass:"!p-0",attrs:{type:"link"},on:{click:function(t){e.handleCopyLink(`![${e.attachment.name}](${e.attachment.path})`)}}},[t("a-icon",{attrs:{type:"copy"}})],1)],1)])],1):e._e()],1)],1)],1)],1)},Ot=[],At=a(3775),Zt={name:"AttachmentDetailModal",mixins:[At.jB,At.KT],filters:{typeText(e){return e?Tt.k[e].text:""}},props:{visible:{type:Boolean,default:!0},teams:{type:Array,default:()=>[]},attachment:{type:Object,default:()=>({})}},data(){return{nameEditable:!1,teamEditable:!1,deleting:!1,deleteErrored:!1}},computed:{modalVisible:{get(){return this.visible},set(e){this.$emit("update:visible",e)}},isImage(){return!(!this.attachment||!this.attachment.mediaType)&&this.attachment.mediaType.startsWith("image")}},methods:{async handleDelete(){try{this.deleting=!0,await yt.Z.attachment.delete(this.attachment.id)}catch(e){this.$log.error(e),this.deleteErrored=!0}finally{setTimeout((()=>{this.deleting=!1}),400)}},handleDeletedCallback(){this.$emit("delete",this.attachment),this.deleteErrored=!1,this.modalVisible=!1},handleEditName(){this.nameEditable=!this.nameEditable,this.nameEditable&&this.$nextTick((()=>{this.$refs.nameInput.focus()}))},async handleUpdateName(){if(this.attachment.name)try{await yt.Z.attachment.update(this.attachment.id,this.attachment.name)}catch(e){this.$log.error(e)}finally{this.nameEditable=!1}else this.$notification["error"]({message:"提示",description:"附件名称不能为空！"})},handleEditTeam(){this.teamEditable=!this.teamEditable,this.teamEditable&&this.$nextTick((()=>{this.$refs.teamInput.focus()}))},async handleUpdateTeam(){this.attachment.team||(this.attachment.team="");try{await yt.Z.attachment.update(this.attachment.id,void 0,this.attachment.team)}catch(e){this.$log.error(e)}finally{this.teamEditable=!1}},handleCopyLink(e){this.$copyText(e).then((e=>{this.$log.debug("copy",e),this.$message.success("复制成功！")})).catch((e=>{this.$log.debug("copy.err",e),this.$message.error("复制失败！")}))}}},Pt=Zt,Ht=(0,c.Z)(Pt,jt,Ot,!1,null,null,null),$t=Ht.exports,Mt=function(){var e=this,t=e._self._c;return t("a-button",{attrs:{block:e.block,icon:e.computedIcon,loading:e.loading,size:e.size,type:e.computedType},on:{click:e.handleClick}},[e._v(e._s(e.computedText)+" ")])},Dt=[],Ft={name:"ReactiveButton",props:{type:{type:String,default:"primary"},icon:{type:String,default:null},size:{type:String,default:"default"},block:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},errored:{type:Boolean,default:!1},text:{type:String,default:""},loadedText:{type:String,default:""},erroredText:{type:String,default:""}},data(){return{loaded:!1,hasError:!1}},watch:{loading(e){e||(this.loaded=!0,this.errored&&(this.hasError=!0),setTimeout((()=>{this.loaded=!1,this.hasError=!1,this.$emit("callback")}),400))}},computed:{computedType(){return this.loaded&&this.hasError?"danger":this.type},computedIcon(){return this.loaded?this.hasError?"close-circle":"check-circle":this.icon},computedText(){return this.loaded?this.hasError?this.erroredText:this.loadedText:this.text}},methods:{handleClick(){this.$emit("click")}}},Nt=Ft,Rt=(0,c.Z)(Nt,Mt,Dt,!1,null,null,null),Bt=Rt.exports,Ut=function(){var e=this,t=e._self._c;return t("a-tag",{style:{color:e.labelColor},attrs:{color:e.tag.color}},[e._v(" "+e._s(e.tag.name)+" "),void 0!==e.tag.postCount?t("span",[e._v("("+e._s(e.tag.postCount)+")")]):e._e()])},Gt=[],Vt=a(97697),Kt={name:"PostTag",props:{tag:{type:Object,default:()=>{}}},computed:{labelColor(){const{color:e}=this.tag||{};return e&&(0,Vt.vq)(e)?(0,Vt.RQ)(e)?"inherit":"#fff":"inherit"}}},zt=Kt,Yt=(0,c.Z)(zt,Ut,Gt,!1,null,null,null),qt=Yt.exports,Wt=function(){var e=this,t=e._self._c;return"REPEATER"===e.itemSetting.type?t("a-form-item",[t("RepeaterInput",{attrs:{itemSetting:e.itemSetting},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1):t("a-form-item",{attrs:{label:e.itemSetting.label+"："}},[e.itemSetting.description&&""!==e.itemSetting.description?t("p",{attrs:{slot:"help"},domProps:{innerHTML:e._s(e.itemSetting.description)},slot:"help"}):e._e(),"TEXT"===e.itemSetting.type&&0===e.itemSetting.options.length?t("a-input",{attrs:{defaultValue:e.itemSetting.defaultValue,placeholder:e.itemSetting.placeholder},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):"TEXT"===e.itemSetting.type?t("a-auto-complete",{staticStyle:{width:"100%"},attrs:{defaultValue:e.itemSetting.defaultValue,placeholder:e.itemSetting.placeholder,dataSource:e.completeOptions,allowClear:""},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):"TEXTAREA"===e.itemSetting.type?t("a-input",{attrs:{autoSize:{minRows:5},placeholder:e.itemSetting.placeholder,type:"textarea"},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):"CODE"===e.itemSetting.type?t("Codemirror",{staticClass:"code-input",attrs:{extensions:e.languageExtensions,height:null},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):"RADIO"===e.itemSetting.type?t("a-radio-group",{attrs:{defaultValue:e.itemSetting.defaultValue},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}},e._l(e.itemSetting.options,(function(a,n){return t("a-radio",{key:n,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1):"CHECKBOX"===e.itemSetting.type?t("CheckboxInput",{attrs:{itemSetting:e.itemSetting},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):"SELECT"===e.itemSetting.type?t("a-select",{attrs:{defaultValue:e.itemSetting.defaultValue},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}},e._l(e.itemSetting.options,(function(a){return t("a-select-option",{key:a.value,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1):"COLOR"===e.itemSetting.type?t("verte",{staticStyle:{display:"inline-block",height:"24px"},attrs:{defaultValue:e.itemSetting.defaultValue,model:"hex",picker:"square"},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):"ATTACHMENT"===e.itemSetting.type?t("AttachmentInput",{attrs:{defaultValue:e.itemSetting.defaultValue,placeholder:e.itemSetting.placeholder},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):"NUMBER"===e.itemSetting.type?t("a-input-number",{staticStyle:{width:"100%"},attrs:{defaultValue:e.itemSetting.defaultValue,placeholder:e.itemSetting.placeholder},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):"SWITCH"===e.itemSetting.type?t("a-switch",{attrs:{defaultChecked:e.itemSetting.defaultValue},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}}):t("a-input",{attrs:{defaultValue:e.itemSetting.defaultValue,placeholder:e.itemSetting.placeholder},model:{value:e.value[e.itemSetting.name],callback:function(t){e.$set(e.value,e.itemSetting.name,t)},expression:"value[itemSetting.name]"}})],1)},Xt=[],Jt=a(94927),Qt=a(71240),ea=a(61426),ta={name:"SettingFormItem",components:{Codemirror:Qt.Z,Verte:Jt.Z},props:{value:{type:Object,default:()=>{}},itemSetting:{type:Object,default:()=>{}}},data(){return{languageExtensions:[(0,ea.iv)()]}},computed:{completeOptions(){let e=String(this.value[this.itemSetting.name]),t=this.itemSetting.options.map((e=>String(e.value)));return!e||t.includes(e)?t:[e,...t]}}},aa=ta,na=(0,c.Z)(aa,Wt,Xt,!1,null,null,null),ia=na.exports,sa=function(){var e=this,t=e._self._c;return t("a-card",{attrs:{title:e.itemSetting.label+"："}},[e.itemSetting.description&&""!==e.itemSetting.description?t("p",{domProps:{innerHTML:e._s(e.itemSetting.description)}}):e._e(),t("a-space",{staticClass:"repeater",attrs:{direction:"vertical"}},[e._l(e.valueList,(function(a,n){return t("a-row",{key:n,staticClass:"ant-card ant-card-bordered",attrs:{type:"flex"}},[t("a-col",{staticStyle:{padding:"10px"},attrs:{flex:"1"}},e._l(e.itemSetting.children,(function(a,i){return t("SettingFormItem",{key:i,attrs:{itemSetting:a},model:{value:e.valueList[n],callback:function(t){e.$set(e.valueList,n,t)},expression:"valueList[formValIndex]"}})})),1),t("a-col",{staticClass:"repeater-control",attrs:{flex:"38px"}},[t("a-space",{attrs:{direction:"vertical"}},[t("a-icon",{class:0===n?"forbidden":"",attrs:{type:"up-circle"},on:{click:function(t){return e.handleUpItem(n)}}}),t("a-icon",{attrs:{type:"plus-circle"},on:{click:function(t){return e.handleAddItem(n)}}}),t("a-icon",{attrs:{type:"close-circle"},on:{click:function(t){return e.handleRemoveItem(n)}}}),t("a-icon",{class:n===e.valueList.length-1?"forbidden":"",attrs:{type:"down-circle"},on:{click:function(t){return e.handleDownItem(n)}}})],1)],1)],1)})),t("a-button",{attrs:{icon:"plus-circle"},on:{click:function(t){return e.handleAddItem(e.valueList.length)}}},[e._v("添加")])],2)],1)},oa=[],la={name:"RepeaterInput",props:{value:{type:Object,default:()=>{}},itemSetting:{type:Object,default:()=>{}}},data(){let e=this.value[this.itemSetting.name];return{valueList:void 0===e?[]:JSON.parse(e)}},watch:{valueList:{handler(e){this.value[this.itemSetting.name]=JSON.stringify(e)},deep:!0}},methods:{handleAddItem(e){let t={};for(let a of this.itemSetting.children)a.defaultValue&&(t[a.name]=a.defaultValue);this.valueList.splice(e,0,t),this.$forceUpdate()},handleRemoveItem(e){this.valueList.splice(e,1),this.$forceUpdate()},handleUpItem(e){e>0&&(this.exchangeItem(e-1,e),this.$forceUpdate())},handleDownItem(e){e<this.valueList.length-1&&(this.exchangeItem(e,e+1),this.$forceUpdate())},exchangeItem(e,t){let a=this.valueList[e];this.$set(this.valueList,e,this.valueList[t]),this.$set(this.valueList,t,a)}}},ra=la,da=(0,c.Z)(ra,sa,oa,!1,null,"614e94ea",null),ca=da.exports,ua=function(){var e=this,t=e._self._c;return t("a-checkbox-group",{model:{value:e.valueList,callback:function(t){e.valueList=t},expression:"valueList"}},e._l(e.itemSetting.options,(function(a,n){return t("a-checkbox",{key:n,attrs:{value:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)},ma=[],ha={name:"CheckboxInput",props:{value:{type:Object,default:()=>{}},itemSetting:{type:Object,default:()=>{}}},data(){let e=this.value[this.itemSetting.name];return{valueList:void 0===e?[]:JSON.parse(e)}},watch:{valueList:{handler(e){this.value[this.itemSetting.name]=JSON.stringify(e)},deep:!0}}},pa=ha,fa=(0,c.Z)(pa,ua,ma,!1,null,null,null),ga=fa.exports,va=function(){var e=this,t=e._self._c;return t("div",[t("a-input",{ref:"attachmentInput",attrs:{defaultValue:e.defaultValue,placeholder:e.placeholder,value:e.value},on:{change:e.onInputChange},scopedSlots:e._u([{key:"addonAfter",fn:function(){return[t("a-button",{staticClass:"!p-0 !h-auto",attrs:{type:"link"},on:{click:function(t){e.attachmentModalVisible=!0}}},[t("a-icon",{attrs:{type:"picture"}})],1)]},proxy:!0}])}),t("AttachmentSelectModal",{attrs:{multiSelect:!1,visible:e.attachmentModalVisible},on:{"update:visible":function(t){e.attachmentModalVisible=t},confirm:e.handleSelectAttachment}})],1)},ya=[],ba={name:"AttachmentInput",props:{value:{type:String,default:""},defaultValue:{type:String,default:""},placeholder:{type:String,default:""},title:{type:String,default:"选择附件"}},data(){return{attachmentModalVisible:!1}},methods:{onInputChange(e){this.$emit("input",e.target.value)},handleSelectAttachment({raw:e}){e.length&&this.$emit("input",e[0].path)},focus(){this.$refs.attachmentInput.focus()}}},Sa=ba,xa=(0,c.Z)(Sa,va,ya,!1,null,null,null),_a=xa.exports,ka=function(){var e=this,t=e._self._c;return t("a-list",{attrs:{dataSource:e.comments,loading:e.loading,"item-layout":"vertical"},scopedSlots:e._u([{key:"renderItem",fn:function(a,n){return[t("a-list-item",{key:n,staticClass:"!p-0",class:{"hover:bg-gray-100 hover:!px-1 hover:rounded transition-all cursor-pointer":e.clickable},on:{click:function(t){return e.handleClick(a)}}},[t("a-comment",{attrs:{avatar:a.avatar},scopedSlots:e._u([{key:"author",fn:function(){return[a.authorUrl?t("a",{staticClass:"!text-gray-800 hover:!text-blue-500",attrs:{href:a.authorUrl,target:"_blank"}},[e._v(" "+e._s(a.author)+" ")]):t("span",{staticClass:"!text-gray-500"},[e._v(e._s(a.author))]),e._v(" 发表在 "),t("span",{staticClass:"hover:!text-blue-500 cursor-pointer",on:{click:function(t){return e.handleOpenTarget(a)}}},[e._v(" 《"+e._s(e.targetTitle(a))+"》 ")])]},proxy:!0},{key:"content",fn:function(){return[t("p",{domProps:{innerHTML:e._s(e.$options.filters.markdownRender(a.content))}})]},proxy:!0},{key:"datetime",fn:function(){return[t("a-tooltip",{attrs:{title:e._f("moment")(a.createTime)}},[t("span",[e._v(e._s(e._f("timeAgo")(a.createTime)))])])]},proxy:!0}],null,!0)})],1)]}}])})},Ca=[],Ta={name:"CommentListView",props:{comments:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},clickable:{type:Boolean,default:!1}},computed:{targetTitle(){return function(e){return e.post?e.post.title:e.sheet?e.sheet.title:e.journal?(0,Me._)(e.journal.createTime):""}}},methods:{async handleOpenTarget(e){const{post:t,sheet:a}=e;if(t||a){const{status:e,fullPath:n,id:i}=t||a;if(["PUBLISHED","INTIMATE"].includes(e))return void window.open(n,"_blank");if("DRAFT"===e){const e=t?"post":"sheet",a=await yt.Z[e].getPreviewLinkById(i);window.open(a,"_blank")}}},handleClick(e){this.clickable&&this.$emit("click",e)}}},Ea=Ta,wa=(0,c.Z)(Ea,ka,Ca,!1,null,null,null),La=wa.exports;const Ia={Ellipsis:ze,FooterToolbar:et,FilePondUpload:ft,AttachmentUploadModal:_t,AttachmentSelectModal:It,AttachmentDetailModal:$t,ReactiveButton:Bt,PostTag:qt,SettingFormItem:ia,RepeaterInput:ca,CheckboxInput:ga,AttachmentInput:_a,CommentListView:La},ja={};Object.keys(Ia).forEach((e=>{ja[e]=n["default"].component(e,Ia[e])}));var Oa={i8:"1.1.0"};n["default"].config.productionTip=!1,n["default"].prototype.VERSION=Oa.i8,n["default"].use(f),n["default"].use(g.Z),new n["default"]({router:f,store:v.Z,render:e=>e(m)}).$mount("#app")},3775:function(e,t,a){"use strict";a.d(t,{KT:function(){return o},g3:function(){return l},jB:function(){return s}});var n=a(80315),i=a(20629);const s={computed:{...(0,i.rn)({layoutMode:e=>e.app.layout,navTheme:e=>e.app.theme,primaryColor:e=>e.app.color,fixedHeader:e=>e.app.fixedHeader,fixedSidebar:e=>e.app.fixedSidebar,contentWidth:e=>e.app.contentWidth,autoHideHeader:e=>e.app.autoHideHeader,sidebarOpened:e=>e.app.sidebar})},methods:{isTopMenu(){return"topmenu"===this.layoutMode},isSideMenu(){return!this.isTopMenu()}}},o={computed:{...(0,i.rn)({device:e=>e.app.device})},methods:{isMobile(){return this.device===n.m.MOBILE},isDesktop(){return this.device===n.m.DESKTOP},isTablet(){return this.device===n.m.TABLET}}},l={data(){return{viewMetas:{pageHeaderHeight:0,pageFooterHeight:0}}},computed:{editorHeight(){const e=64,t=24,a=40;return`calc(100vh - ${e+t+a+this.viewMetas.pageHeaderHeight+this.viewMetas.pageFooterHeight+10}px - 1rem)`}},mounted(){this.handleGetViewMetas()},methods:{handleGetViewMetas(){const e=document.getElementsByClassName("page-header");e&&e.length>0&&(this.viewMetas.pageHeaderHeight=e[0].clientHeight);const t=document.getElementsByClassName("ant-layout-footer");t&&t.length>0&&(this.viewMetas.pageFooterHeight=t[0].clientHeight)}}}},86941:function(e,t,a){"use strict";a.d(t,{Z:function(){return g}});var n=a(20144),i=a(20629),s=a(28762),o=a(73541);const l={state:{sidebar:!0,device:"desktop",theme:"",layout:"",contentWidth:"",fixedHeader:!1,fixedSidebar:!1,autoHideHeader:!1,color:null,layoutSetting:!1,loginModal:!1,isInstalled:void 0},mutations:{SET_SIDEBAR_TYPE:(e,t)=>{n["default"].ls.set(s.mQ,t),e.sidebar=t},TOGGLE_DEVICE:(e,t)=>{e.device=t},TOGGLE_THEME:(e,t)=>{n["default"].ls.set(s.t0,t),e.theme=t},TOGGLE_LAYOUT_MODE:(e,t)=>{n["default"].ls.set(s.v9,t),e.layout=t},TOGGLE_FIXED_HEADER:(e,t)=>{n["default"].ls.set(s.Vv,t),e.fixedHeader=t},TOGGLE_FIXED_SIDEBAR:(e,t)=>{n["default"].ls.set(s.lK,t),e.fixedSidebar=t},TOGGLE_FIXED_HEADER_HIDDEN:(e,t)=>{n["default"].ls.set(s.NK,t),e.autoHideHeader=t},TOGGLE_CONTENT_WIDTH:(e,t)=>{n["default"].ls.set(s.hC,t),e.contentWidth=t},TOGGLE_COLOR:(e,t)=>{n["default"].ls.set(s.Dp,t),e.color=t},TOGGLE_LAYOUT_SETTING:(e,t)=>{n["default"].ls.set(s.W1,t),e.layoutSetting=t},TOGGLE_LOGIN_MODAL:(e,t)=>{e.loginModal=t},SET_IS_INSTALLED:(e,t)=>{e.isInstalled=t}},actions:{fetchIsInstalled({commit:e}){return new Promise(((t,a)=>{o.Z.isInstalled().then((a=>{e("SET_IS_INSTALLED",a.data),t(a)})).catch((e=>{a(e)}))}))},setSidebar({commit:e},t){e("SET_SIDEBAR_TYPE",t)},ToggleTheme({commit:e},t){e("TOGGLE_THEME",t)},ToggleLayoutMode({commit:e},t){e("TOGGLE_LAYOUT_MODE",t)},ToggleFixedHeader({commit:e},t){e("TOGGLE_FIXED_HEADER",t)},ToggleFixedSidebar({commit:e},t){e("TOGGLE_FIXED_SIDEBAR",t)},ToggleFixedHeaderHidden({commit:e},t){e("TOGGLE_FIXED_HEADER_HIDDEN",t)},ToggleContentWidth({commit:e},t){e("TOGGLE_CONTENT_WIDTH",t)},ToggleColor({commit:e},t){e("TOGGLE_COLOR",t)},ToggleLayoutSetting({commit:e},t){e("TOGGLE_LAYOUT_SETTING",t)},ToggleLoginModal({commit:e},t){e("TOGGLE_LOGIN_MODAL",t)}}};var r=l;const d={state:{token:null,user:{}},mutations:{SET_TOKEN:(e,t)=>{n["default"].ls.set(s.LA,t,t?1e3*t.expired_in:null),e.token=t},CLEAR_TOKEN:e=>{n["default"].ls.remove(s.LA),e.token=null},SET_USER:(e,t)=>{n["default"].ls.set(s.xR,t),e.user=t}},actions:{installCleanToken({commit:e},t){return new Promise(((a,n)=>{o.Z.installation.install(t).then((t=>{e("CLEAR_TOKEN"),a(t)})).catch((e=>{n(e)}))}))},refreshUserCache({commit:e}){return new Promise(((t,a)=>{o.Z.user.getProfile().then((a=>{e("SET_USER",a.data),t(a)})).catch((e=>{a(e)}))}))},login({commit:e},{username:t,password:a,authcode:i}){return new Promise(((s,l)=>{o.Z.login({username:t,password:a,authcode:i}).then((t=>{const a=t.data;n["default"].$log.debug("Got token",a),e("SET_TOKEN",a),s(t)})).catch((e=>{l(e)}))}))},logout({commit:e}){return new Promise((t=>{o.Z.logout().then((()=>{e("CLEAR_TOKEN"),e("SET_USER",{}),t()})).catch((()=>{t()}))}))},refreshToken({commit:e},t){return new Promise(((a,i)=>{o.Z.refreshToken(t).then((t=>{const i=t.data;n["default"].$log.debug("Got token",i),e("SET_TOKEN",i),a(t)})).catch((a=>{const s=a.data;n["default"].$log.debug("Refresh error data",s),s&&400===s.status&&s.data===t&&e("CLEAR_TOKEN"),i(a)}))}))}}};var c=d;const u=["blog_url","developer_mode","attachment_upload_image_preview_enable","attachment_EXIF_remove_enable","attachment_upload_max_parallel_uploads","attachment_upload_max_files","sheet_prefix","post_permalink_type","sheet_permalink_type","archives_prefix","path_suffix","default_editor","default_menu_team"],m={state:{options:void 0},mutations:{SET_OPTIONS:(e,t)=>{n["default"].ls.set(s.JY,t),e.options=t}},actions:{refreshOptionsCache({commit:e}){return new Promise(((t,a)=>{o.Z.option.listAsMapViewByKeys(u).then((a=>{e("SET_OPTIONS",a.data),t(a)})).catch((e=>{a(e)}))}))}}};var h=m;const p={device:e=>e.app.device,theme:e=>e.app.theme,color:e=>e.app.color,layoutSetting:e=>e.app.layoutSetting,sidebar:e=>e.app.sidebar,loginModal:e=>e.app.loginModal,isInstalled:e=>e.app.isInstalled,token:e=>e.user.token,user:e=>e.user.user,options:e=>e.option.options};var f=p;n["default"].use(i.ZP);var g=new i.ZP.Store({modules:{app:r,user:c,option:h},state:{},mutations:{},actions:{},getters:f})},28762:function(e,t,a){"use strict";a.d(t,{Dp:function(){return l},JY:function(){return h},LA:function(){return n},NK:function(){return c},Vv:function(){return r},W1:function(){return p},hC:function(){return u},lK:function(){return d},mQ:function(){return i},t0:function(){return s},v9:function(){return o},xR:function(){return m}});const n="Access-Token",i="SIDEBAR_TYPE",s="DEFAULT_THEME",o="DEFAULT_LAYOUT_MODE",l="DEFAULT_COLOR",r="DEFAULT_FIXED_HEADER",d="DEFAULT_FIXED_SIDEBAR",c="DEFAULT_FIXED_HEADER_HIDDEN",u="DEFAULT_CONTENT_WIDTH_TYPE",m="USER",h="OPTIONS",p="LAYOUT_SETTING"},73541:function(e,t,a){"use strict";a(57658);var n=a(10308),i=a(86941),s=a(61446),o=a(70473),l=a(84722);const r=localStorage.getItem("apiUrl"),d=r||"",c=new n.HaloRestAPIClient({baseUrl:d}),u=new n.AdminApiClient(c);c.interceptors.request.use((e=>{const t=i.Z.getters.token;return t&&t.access_token&&(e.headers["Admin-Authorization"]=t.access_token),e}),(e=>Promise.reject(e)));let m=!1,h=[];c.interceptors.response.use((e=>e),(async e=>{if(n.Axios.isCancel(e))return Promise.reject(e);if(/Network Error/.test(e.message))return s.Z.error("网络错误，请检查网络连接"),Promise.reject(e);const t=i.Z.getters.token,a=e.config,r=e.response,d=r?r.data:null;if(d){if(400===d.status){const t=d.data;if((0,l.Kn)(t)){const e=Object.keys(t||{}).map((e=>t[e]));o.Z.error({message:d.message,description:t=>{const a=e.map((e=>t("a-alert",{props:{message:e,banner:!0,showIcon:!1,type:"error"}})));return t("div",a)},duration:10})}else s.Z.error(d.message);return Promise.reject(e)}if(401===d.status){if(m)return new Promise((e=>{h.push((()=>{e((0,n.Axios)(a))}))}));m=!0;try{return await i.Z.dispatch("refreshToken",t.refresh_token),h.forEach((e=>e())),h=[],(0,n.Axios)(a)}catch(c){return s.Z.warning("当前登录状态已失效，请重新登录"),await i.Z.dispatch("ToggleLoginModal",!0),Promise.reject(c)}finally{m=!1}}return s.Z.error(d.message||"服务器错误"),Promise.reject(e)}return s.Z.error("网络异常"),Promise.reject(e)})),t.Z=u},97697:function(e,t,a){"use strict";a.d(t,{RQ:function(){return n},aX:function(){return i},vq:function(){return s}});const n=e=>{if(!s(e))return!1;let t,a,n,i;return e.match(/^rgb/)?(e=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),t=e[1],a=e[2],n=e[3]):(e=+("0x"+e.slice(1).replace(e.length<5&&/./g,"$&$&")),t=e>>16,a=e>>8&255,n=255&e),i=Math.sqrt(t*t*.299+a*a*.587+n*n*.114),i>127.5},i=/(^#[0-9A-F])/i,s=e=>i.test(e)},48478:function(e,t,a){"use strict";a.d(t,{S:function(){return o},_:function(){return s}});var n=a(27484),i=a.n(n);a(33852);function s(e=new Date,t="YYYY-MM-DD HH:mm"){return i()(e).format(t)}function o(e){const t=(new Date).getTime(),a=t-e,n=Math.floor(a/864e5);if(0===n){const e=a%864e5,t=Math.floor(e/36e5);if(0===t){const t=e%36e5,a=Math.floor(t/6e4);if(0===a){const e=t%6e4,a=Math.round(e/1e3);return a+" 秒前"}return a+" 分钟前"}return t+" 小时前"}return n<0?"刚刚":n<5?n+" 天前":i()(e).format("YYYY-MM-DD HH:mm")}i().locale("zh-cn")},80315:function(e,t,a){"use strict";a.d(t,{A:function(){return o},m:function(){return s}});var n=a(24974),i=a.n(n);const s={DESKTOP:"desktop",TABLET:"tablet",MOBILE:"mobile"},o=function(e){const t={match:()=>{e&&e(s.DESKTOP)}},a={match:()=>{e&&e(s.TABLET)}},n={match:()=>{e&&e(s.MOBILE)}};i().register("screen and (max-width: 576px)",n).register("screen and (min-width: 576px) and (max-width: 1199px)",a).register("screen and (min-width: 1200px)",t)}},84722:function(e,t,a){"use strict";function n(){const e=document.createEvent("HTMLEvents");e.initEvent("resize",!0,!0),e.eventType="message",window.dispatchEvent(e)}function i(e){return e&&"object"===typeof e&&e.constructor===Object}function s(e){if(!e&&"object"!==typeof e)throw new Error("error arguments");const t=e.constructor===Array?[]:{};return Object.keys(e).forEach((a=>{e[a]&&"object"===typeof e[a]?t[a]=s(e[a]):t[a]=e[a]})),t}a.d(t,{I8:function(){return s},Kn:function(){return i},XC:function(){return n}})},24654:function(){}},t={};function a(n){var i=t[n];if(void 0!==i)return i.exports;var s=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.loaded=!0,s.exports}a.m=e,function(){var e=[];a.O=function(t,n,i,s){if(!n){var o=1/0;for(c=0;c<e.length;c++){n=e[c][0],i=e[c][1],s=e[c][2];for(var l=!0,r=0;r<n.length;r++)(!1&s||o>=s)&&Object.keys(a.O).every((function(e){return a.O[e](n[r])}))?n.splice(r--,1):(l=!1,s<o&&(o=s));if(l){e.splice(c--,1);var d=i();void 0!==d&&(t=d)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,i,s]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.f={},a.e=function(e){return Promise.all(Object.keys(a.f).reduce((function(t,n){return a.f[n](e,t),t}),[]))}}(),function(){a.u=function(e){return"js/"+e+"."+{109:"0b0ad44f",132:"f2ea279f",171:"98fa27eb",240:"32ab7727",1010:"e15d0acd",1044:"c2ad1f72",1125:"dc34b73d",1162:"99115383",1195:"cebd7b34",1261:"1c953617",1292:"74326aab",1426:"0ff93d04",1504:"1282571e",1644:"9270f115",1763:"94ee52b6",1909:"f739ad42",2183:"4407111f",2389:"880ded4c",2661:"385db619",2693:"006017be",2696:"c2f4f77d",2700:"8f0201f7",2887:"1ddf3ce0",3086:"2e8fa54a",3203:"f4901879",3271:"cd829250",3311:"6ce6ad80",3339:"5b1721fd",3343:"0925b513",3541:"90721fa1",3619:"77cd3c88",4221:"196cdc12",4238:"f8e55eeb",4368:"6159f65e",4510:"67defcd0",4609:"d2d90bd8",4659:"43cb01ff",4706:"0842553c",4849:"34d79a74",5084:"256fd69e",5201:"a9bd6c08",5269:"e80157a5",5326:"26763d3d",5353:"2230dd51",5747:"2486845b",5760:"4159d852",5790:"fc960d29",5943:"7e27ca53",6255:"3f2cbe2d",6648:"4edfc9a8",6673:"a38c49f4",6985:"91bc2ccc",7378:"7cdef900",7682:"813f7f1f",7936:"36ea9cfd",8016:"fb54fe6e",8370:"b7b26791",8955:"41d315cf",9138:"fc279356",9773:"a2a87678",9831:"aefacd57",9893:"591c5759",9975:"9e27d5c9",9980:"73c6a51a"}[e]+".js"}}(),function(){a.miniCssF=function(e){return"css/"+e+"."+{1292:"c757c33d",3271:"b4bea94e",4368:"c5039421",4609:"828845cf",5084:"f14bd7a4",7378:"0799c71a",9831:"3db0de18"}[e]+".css"}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="halo-admin:";a.l=function(n,i,s,o){if(e[n])e[n].push(i);else{var l,r;if(void 0!==s)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==n||u.getAttribute("data-webpack")==t+s){l=u;break}}l||(r=!0,l=document.createElement("script"),l.charset="utf-8",l.timeout=120,a.nc&&l.setAttribute("nonce",a.nc),l.setAttribute("data-webpack",t+s),l.src=n),e[n]=[i];var m=function(t,a){l.onerror=l.onload=null,clearTimeout(h);var i=e[n];if(delete e[n],l.parentNode&&l.parentNode.removeChild(l),i&&i.forEach((function(e){return e(a)})),t)return t(a)},h=setTimeout(m.bind(null,void 0,{type:"timeout",target:l}),12e4);l.onerror=m.bind(null,l.onerror),l.onload=m.bind(null,l.onload),r&&document.head.appendChild(l)}}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){if("undefined"!==typeof document){var e=function(e,t,a,n,i){var s=document.createElement("link");s.rel="stylesheet",s.type="text/css";var o=function(a){if(s.onerror=s.onload=null,"load"===a.type)n();else{var o=a&&("load"===a.type?"missing":a.type),l=a&&a.target&&a.target.href||t,r=new Error("Loading CSS chunk "+e+" failed.\n("+l+")");r.code="CSS_CHUNK_LOAD_FAILED",r.type=o,r.request=l,s.parentNode&&s.parentNode.removeChild(s),i(r)}};return s.onerror=s.onload=o,s.href=t,a?a.parentNode.insertBefore(s,a.nextSibling):document.head.appendChild(s),s},t=function(e,t){for(var a=document.getElementsByTagName("link"),n=0;n<a.length;n++){var i=a[n],s=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(s===e||s===t))return i}var o=document.getElementsByTagName("style");for(n=0;n<o.length;n++){i=o[n],s=i.getAttribute("data-href");if(s===e||s===t)return i}},n=function(n){return new Promise((function(i,s){var o=a.miniCssF(n),l=a.p+o;if(t(o,l))return i();e(n,l,null,i,s)}))},i={2143:0};a.f.miniCss=function(e,t){var a={1292:1,3271:1,4368:1,4609:1,5084:1,7378:1,9831:1};i[e]?t.push(i[e]):0!==i[e]&&a[e]&&t.push(i[e]=n(e).then((function(){i[e]=0}),(function(t){throw delete i[e],t})))}}}(),function(){var e={2143:0};a.f.j=function(t,n){var i=a.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var s=new Promise((function(a,n){i=e[t]=[a,n]}));n.push(i[2]=s);var o=a.p+a.u(t),l=new Error,r=function(n){if(a.o(e,t)&&(i=e[t],0!==i&&(e[t]=void 0),i)){var s=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",l.name="ChunkLoadError",l.type=s,l.request=o,i[1](l)}};a.l(o,r,"chunk-"+t,t)}},a.O.j=function(t){return 0===e[t]};var t=function(t,n){var i,s,o=n[0],l=n[1],r=n[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(i in l)a.o(l,i)&&(a.m[i]=l[i]);if(r)var c=r(a)}for(t&&t(n);d<o.length;d++)s=o[d],a.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return a.O(c)},n=self["webpackChunkhalo_admin"]=self["webpackChunkhalo_admin"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[4998],(function(){return a(57521)}));n=a.O(n)})();